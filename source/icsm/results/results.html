<div ng-show="!list || !list.length">
	<div class="alert alert-warning" role="alert"><strong>Select an area</strong> to find datasets within.</div>
</div>

<div ng-show="list.length">
	<div class="row">
		<div class="col-md-5" uib-tooltip="Number of intersecting or very near datasets to your area of interest.">
			<h4 style="display:inline-block">Found {{products.length}} datasets</h4>
		</div>
		<div class="col-md-7">
			<div class="input-group input-group-sm">
				<span class="input-group-addon" id="names1">Filter:</span>
				<input type="text" ng-model="filters.filter" class="form-control" ng-change="update()" placeholder="Filter names" aria-describedby="names1">
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div class="panel panel-default">
				<div class="panel-body">
					<span class="listTypeLabel">Filter by type:</span>
					<span ng-repeat="type in filters.types" class="listType">
                  <input type="checkbox" ng-model="type.selected" ng-change="update()"/>
                  <span uib-tooltip="{{type.description}}">{{type.label}}</span>
					</span>
				</div>
			</div>
		</div>
	</div>

	<div ng-repeat="available in list" class="well" ng-show="list.someMatches(available)" ng-controller="listCtrl as list">
		<h5>
			<button class="undecorated" ng-click="expansions[available.source] = !expansions[available.source]" uib-tooltip="Click to collapse/expand this group"
				aria-expanded="true" aria-controls="collapse{{mappings[available.source].code}}">
            <img ng-src="{{mappings[available.source].image}}" ng-attr-style="height:{{mappings[available.source].height}}px"></img>
         </button>
			<strong>{{available.source}}</strong> (Showing {{available.downloadables | countMatchedDownloadables}} of {{available.downloadables	| countDownloadables}})
			<span class="listTopExpander">
            <button class="undecorated" ng-click="expansions[available.source] = !expansions[available.source]">
               [{{expansions[available.source]?"collapse":"expand"}}]
            </button>
         </span>
		</h5>
		<div uib-collapse="!expansions[available.source]">
			<div class="listRow" ng-class-odd="'listEven'" ng-repeat="(typeKey, types) in available.downloadables | allowedTypes">
				<h5><strong>{{typeKey}}</strong></h5>
				<div  ng-repeat="(key, items) in types">
					<div>
						<h5>
							<button ng-click="list.checkChildren(items)" style="width:7em" class="btn btn-xs btn-default">
                        <span ng-show="!list.childrenChecked(items)">Select all</span>
                        <span ng-show="list.childrenChecked(items)">Deselect all</span>
                  </button>
							<strong uib-tooltip="{{filter.types[key].description}}">{{key}}</strong>
						</h5>
						<div ng-repeat="item in items | matchedItems" data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">
							<input type="checkbox" ng-model="item.selected" />
							<common-cc4></common-cc4>
							<spam class="listItem">{{item.file_name}}</spam>
							<span style="float:right;width:8em">Size: {{item.file_size | fileSize}}</span>
						</div>
					</div>
				</div>
				<div style="text-align:right"><button class="undecorated" ng-click="expansions[available.source] = false">[collapse]</button></div>
			</div>
		</div>
	</div>
</div>