"use strict";!function(t){t.module("icsm.bounds",[]).directive("icsmBounds",["flashService","messageService","boundsService",function(t,e,n){var i;return{restrict:"AE",link:function(){n.init().then(null,null,function(n){switch(t.remove(i),n.type){case"error":case"warn":case"info":e[n.type](n.text);break;default:t.remove(i),i=t.add(n.text,n.duration?n.duration:8e3,"wait"==n.type)}})}}}]).factory("boundsService",["$http","$q","$rootScope","$timeout","configService","flashService",function(e,n,i,r,a,o){function s(t,e,n){f&&f.notify({text:t,type:e,duration:n})}function c(t){var e=n.defer(),i=p(t);if(i&&i.code)switch(i.code){case"oversize":r(function(){s("","clear"),s("The selected area is too large to process. Please restrict to approximately 2 degrees square.","error"),e.resolve(i)});break;case"undersize":r(function(){s("","clear"),s("X Min and Y Min should be smaller than X Max and Y Max, respectively. Please update the drawn area.","error"),e.resolve(i)});break;default:return n.when(i)}return e.promise}function l(t){var e=(t.xMax-t.xMin)*(t.yMax-t.yMin);return e<1e-11||t.xMax<t.xMin}function d(t){var e=Math.abs((t.xMax-t.xMin)*(t.yMax-t.yMin));return e>4}function u(t){t.xMax=null===t.xMax?null:+t.xMax,t.xMin=null===t.xMin?null:+t.xMin,t.yMax=null===t.yMax?null:+t.yMax,t.yMin=null===t.yMin?null:+t.yMin}function p(t){return u(t),d(t)?{code:"oversize"}:l(t)?{code:"undersize"}:null===t.xMax?{code:"incomplete"}:m(t)?{code:"success"}:{code:"invalid"}}function m(e){return e&&t.isNumber(e.xMax)&&t.isNumber(e.xMin)&&t.isNumber(e.yMax)&&t.isNumber(e.yMin)&&!d(e)&&!l(e)}function h(t){a.getConfig("processing").then(function(n){var r=n.intersectsUrl;if(r){var a=r.replace("{maxx}",t.xMax).replace("{minx}",t.xMin).replace("{maxy}",t.yMax).replace("{miny}",t.yMin);s("Checking there is data in your selected area...","wait",18e4),e.get(a).then(function(t){if(t.data&&t.data.available_data){var e="There is no data held in your selected area. Please try another area.";s("","clear"),t.data.available_data&&t.data.available_data.forEach(function(t){t.downloadables&&(e="There is intersecting data. Select downloads from the list.")}),s(e,null,4e3),i.$broadcast("site.selection",t.data)}},function(t){s("The service that provides the list of datasets is currently unavailable. Please try again later.","error")})}})}var f;return{init:function(){return f=n.defer(),i.$on("icsm.clip.drawn",function(t,e){s("Area drawn. Checking for data..."),c(e).then(function(t){console.log(t),"success"===t.code?(i.$broadcast("icsm.bounds.draw",[e.xMin,e.yMin,e.xMax,e.yMax]),h(e)):i.$broadcast("icsm.clip.draw",{message:"oversize"})})}),f.promise},cancelDraw:function(){drawService.cancelDrawRectangle()},checkSize:function(t){return c(t)}}}])}(angular),function(t){function e(t,e,n){var i=this;n.getMap().then(function(t){i.map=t}),e.getConfig().then(function(t){i.data=t;try{var e=document.createElement("canvas");t.modern=!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(n){t.modern=!1}})}t.module("IcsmApp",["common.altthemes","common.baselayer.control","common.cc","common.featureinfo","common.header","common.legend","common.navigation","common.storage","common.templates","common.toolbar","explorer.config","explorer.confirm","explorer.drag","explorer.enter","explorer.flasher","explorer.googleanalytics","explorer.httpdata","explorer.info","explorer.legend","explorer.message","explorer.modal","explorer.persist","explorer.projects","explorer.tabs","explorer.version","exp.ui.templates","explorer.map.templates","ui.bootstrap","ui.bootstrap-slider","ngAutocomplete","ngRoute","ngSanitize","page.footer","geo.draw","geo.elevation","geo.geosearch","geo.map","geo.maphelper","geo.measure","icsm.bounds","icsm.clip","icsm.glossary","icsm.help","icsm.panes","elvis.header","elvis.results","elvis.reviewing","icsm.mapevents","icsm.select","icsm.splash","icsm.state","icsm.layerswitch","icsm.templates","icsm.view"]).config(["configServiceProvider","projectsServiceProvider","persistServiceProvider","versionServiceProvider",function(t,e,n,i){t.location("icsm/resources/config/config.json"),t.dynamicLocation("icsm/resources/config/appConfig.json?t="),i.url("icsm/assets/package.json"),e.setProject("icsm"),n.handler("local")}]).factory("userService",[function(){function t(){return!0}return{login:t,hasAcceptedTerms:t,setAcceptedTerms:t,getUsername:function(){return"anon"}}}]).controller("RootCtrl",e),e.$invoke=["$http","configService","mapService"]}(angular),function(t){t.module("icsm.clip",["geo.draw"]).directive("icsmInfoBbox",function(){return{restrict:"AE",templateUrl:"icsm/clip/infobbox.html"}}).directive("icsmClip",["$rootScope","$timeout","clipService","messageService","mapService",function(t,e,n,i,r){return{templateUrl:"icsm/clip/clip.html",scope:{bounds:"=",trigger:"=",drawn:"&"},link:function(a,o){function s(e){var n=a.clip;n.xMax=+e.clip.xMax,n.xMin=+e.clip.xMin,n.yMax=+e.clip.yMax,n.yMin=+e.clip.yMin,t.$broadcast("icsm.clip.drawn",n)}var c;a.clip={xMax:null,xMin:null,yMax:null,yMin:null},a.typing=!1,"undefined"==typeof a.showBounds&&(a.showBounds=!1),r.getMap().then(function(t){a.$watch("bounds",function(t){t&&a.trigger?e(function(){a.initiateDraw()}):t||n.cancelDraw()})}),a.check=function(){e.cancel(c),c=e(function(){t.$broadcast("icsm.clip.drawn",a.clip)},4e3)},t.$on("icsm.clip.draw",function(t,n){n&&"oversize"===n.message?(a.oversize=!0,e(function(){delete a.oversize},4e3)):delete a.oversize,a.initiateDraw()}),a.initiateDraw=function(){i.info("Click on the map and drag to define your area of interest."),n.initiateDraw().then(s)}}}}]).factory("clipService",["$q","$rootScope","drawService",function(t,e,n){function i(t){return r.data={clip:{xMax:t.bounds.getEast().toFixed(5),xMin:t.bounds.getWest().toFixed(5),yMax:t.bounds.getNorth().toFixed(5),yMin:t.bounds.getSouth().toFixed(5)}},r.data}var r={initiateDraw:function(){return this.data=null,n.drawRectangle().then(i)},cancelDraw:function(){n.cancelDrawRectangle()}};return r}])}(angular),function(t){function e(t,e){var n=this;t.info("GlossaryCtrl"),e.getTerms().then(function(t){n.terms=t})}function n(t){var e="icsm/resources/config/glossary.json";return{getTerms:function(){return t.get(e,{cache:!0}).then(function(t){return t.data})}}}t.module("icsm.glossary",[]).directive("icsmGlossary",[function(){return{templateUrl:"icsm/glossary/glossary.html"}}]).controller("GlossaryCtrl",e).factory("glossaryService",n),e.$inject=["$log","glossaryService"],n.$inject=["$http"]}(angular),function(t){t.module("elvis.header",[]).controller("headerController",["$scope","$q","$timeout",function(t,e,n){var i=function(t){return t};t.$on("headerUpdated",function(e,n){t.headerConfig=i(n)})}]).directive("elvisHeader",[function(){var e={heading:"ICSM",headingtitle:"ICSM",helpurl:"help.html",helptitle:"Get help about ICSM",helpalttext:"Get help about ICSM",skiptocontenttitle:"Skip to content",skiptocontent:"Skip to content",quicklinksurl:"/search/api/quickLinks/json?lang=en-US"};return{transclude:!0,restrict:"EA",templateUrl:"icsm/header/header.html",scope:{breadcrumbs:"=",heading:"=",headingtitle:"=",helpurl:"=",helptitle:"=",helpalttext:"=",skiptocontenttitle:"=",skiptocontent:"=",quicklinksurl:"="},link:function(n,i,r){t.copy(e);t.forEach(e,function(t,e){e in n||(n[e]=t)})}}}]).factory("headerService",["$http",function(){}])}(angular),function(t,e){function n(t,e){for(var n=t.lat,i=t.lng,r=!1,a=0,o=e.length-1;a<e.length;o=a++){var s=e[a].lat,c=e[a].lng,l=e[o].lat,d=e[o].lng,u=c>i!=d>i&&n<(l-s)*(i-c)/(d-c)+s;u&&(r=!r)}return r}t.module("icsm.layerswitch",[]).directive("icsmLayerswitch",["$http","configService","mapService",function(t,i,r){return{restrict:"AE",link:function(a){var o,s;i.getConfig("layerSwitch").then(function(i){o=i,t.get(o.extentUrl,{cache:!0}).then(function(t){var i=e.geoJson(t.data),a=i.getLayers()[0];a&&(s=a.getLatLngs()),r.getMap().then(function(t){function e(e){var a=t.getBounds();n({lng:a.getWest(),lat:a.getSouth()},s)&&n({lng:a.getWest(),lat:a.getNorth()},s)&&n({lng:a.getEast(),lat:a.getSouth()},s)&&n({lng:a.getEast(),lat:a.getNorth()},s)?r():i()}function i(){a({outside:!0,inside:!1})}function r(){a({outside:!1,inside:!0})}function a(e){t.eachLayer(function(t){t.options&&t.options["switch"]&&(t.options["switch"]==o.inside&&(t._container.style.display=e.inside?"block":"none"),t.options["switch"]==o.outside&&(t._container.style.display=e.outside?"block":"none"))})}t.on("moveend",e),e()})})})}}}])}(angular,L),function(t){function e(t,e){var n=this;t.info("HelpCtrl"),e.getFaqs().then(function(t){n.faqs=t})}function n(t){var e="icsm/resources/config/faqs.json";return{getFaqs:function(){return t.get(e,{cache:!0}).then(function(t){return t.data})}}}t.module("icsm.help",[]).directive("icsmHelp",[function(){return{templateUrl:"icsm/help/help.html"}}]).directive("icsmFaqs",[function(){return{restrict:"AE",templateUrl:"icsm/help/faqs.html",scope:{faqs:"="},link:function(t){t.focus=function(t){$("#faqs_"+t).focus()}}}}]).controller("HelpCtrl",e).factory("helpService",n),e.$inject=["$log","helpService"],n.$inject=["$http"]}(angular),function(t){angular.module("icsm.mapevents",["geo.map"]).directive("icsmMapevents",["icsmMapeventsService",function(t){return{restrict:"AE",link:function(e){t.tickle()}}}]).factory("icsmMapeventsService",["$rootScope","$timeout","configService","mapService",function(t,e,n,i){function r(t){i.getMap().then(function(e){if(s&&e.removeLayer(s),t){var n;n="undefined"!=typeof t.properties.SAMPLE_LONGITUDE?{type:"Point",coordinates:[t.properties.SAMPLE_LONGITUDE,t.properties.SAMPLE_LATITUDE]}:t.geometry,s=L.geoJson({type:"Feature",geometry:n,id:t.id}).addTo(e),t.properties.html&&s.bindPopup(t.properties.html).openPopup()}})}function a(t,n){console.log("pre getting map to make poly"),i.getMap().then(function(i){console.log("getting map to make poly"),c&&i.removeLayer(c),t&&(c=L.geoJson(t,{style:function(t){return{opacity:1,clickable:!1,fillOpacity:0,color:"red"}}}).addTo(i),n&&e(function(){var t=c.getBounds();i.fitBounds(t,{animate:!0,padding:L.point(100,100)})},50))})}function o(t,n){console.log("pre getting map to make bounds"),i.getMap().then(function(i){console.log("getting map to make poly"),l&&i.removeLayer(l),t&&(l=L.geoJson(t,{style:function(t){return{opacity:1,clickable:!1,fillOpacity:0,color:"black"}}}).addTo(i),n&&e(function(){var t=l.getBounds();i.fitBounds(t,{animate:!0,padding:L.point(100,100)})},50))})}var s,c,l,d=n.getConfig("mapConfig");return t.$on("icsm.bounds.draw",function(t,e){if(!e)return void o(null);var n=e[2],i=e[0],r=e[3],a=e[1];o({type:"Feature",geometry:{type:"Polygon",coordinates:[[[i,a],[n,a],[n,r],[i,r],[i,a]]]},properties:{}},!1)}),t.$on("icsm.bbox.draw",function(t,e){if(!e)return void a(null);var n=e[2],i=e[0],r=e[3],o=e[1];a({type:"Feature",geometry:{type:"Polygon",coordinates:[[[i,o],[n,o],[n,r],[i,r],[i,o]]]},properties:{}},!1)}),t.$on("icsm.poly.draw",function(t,e){a(e,!0)}),d.listenForMarkerEvent&&t.$on(d.listenForMarkerEvent,function(t,e){r(e)}),{tickle:function(){i.getMap().then(function(e){e.on("click",function(n){var i=e.getZoom(),r=n.latlng;t.$broadcast("zoom.to",{zoom:i,latlng:r})})})}}}])}(),function(t){function e(t){var e=this;t.data().then(function(t){e.data=t})}function n(){return{add:function(t){},remove:function(t){}}}t.module("icsm.panes",[]).directive("icsmPanes",["$rootScope","$timeout","mapService",function(t,e,n){return{templateUrl:"icsm/panes/panes.html",transclude:!0,scope:{defaultItem:"@",data:"="},controller:["$scope",function(i){var r=!1;i.view=i.defaultItem,i.setView=function(e){var a=i.view;i.view==e?(e&&(r=!0),i.view=""):(e||(r=!0),i.view=e),t.$broadcast("view.changed",i.view,a),r&&n.getMap().then(function(t){t._onResize()})},e(function(){t.$broadcast("view.changed",i.view,null)},50)}]}}]).directive("icsmTabs",[function(){return{templateUrl:"icsm/panes/tabs.html",require:"^icsmPanes"}}]).controller("PaneCtrl",e).factory("paneService",n),e.$inject=["paneService"],n.$inject=[]}(angular),function(t){t.module("icsm.plot",[]).directive("icsmPlot",["$log",function(t){return{restrict:"AE",scope:{line:"="},link:function(e,n,i,r){e.$watch("line",function(e,n){t.info(e)})}}}])}(angular),function(t){function e(e,n){var i=e;return t.forEach(n,function(t,e){i=i.replace("{"+e+"}",encodeURIComponent(t))}),i}function n(t){var e=["file_url","file_name","file_size","bbox"],n={available_data:[]},i=n.available_data,r={};return t.forEach(function(t){var n={};e.forEach(function(e){"undefined"!=typeof t[e]&&(n[e]=t[e])});var a=r[t.source];a||(a={source:t.source,downloadables:{}},r[t.source]=a,i.push(a));var o=a.downloadables[t.type];o||(o={},a.downloadables[t.type]=o);var s=o[t.group];s||(s=[],o[t.group]=s),s.push(n)}),n}t.module("elvis.reviewing",[]).directive("icsmReview",["$rootScope","$uibModal","$log","messageService","reviewService",function(t,e,n,i,r){return{controller:["$scope",function(t,e){}],link:function(t,a){var o;t.data=r.data,t.$watch("data.reviewing",function(a){a&&(o=e.open({templateUrl:"icsm/reviewing/reviewing.html",size:"lg",backdrop:"static",keyboard:!1,controller:["$scope","$uibModalInstance","products",function(t,e,n){t.products=n,t.accept=function(){e.close(!0)},t.cancel=function(){e.close(!1)},t.noneSelected=function(t){return!t.some(function(t){return t.selected})}}],resolve:{products:function(){return r.products}}}),o.result.then(function(e){e&&r.startExtract().then(function(t){i[t.status](t.message)}),r.removeRemoved(),t.data.reviewing=!1},function(){n.info("Cancelled")}))})}}}]).directive("reviewEmail",["reviewService",function(t){return{template:'<div class="input-group"><span class="input-group-addon" id="nedf-email">Email</span><input required="required" type="email" ng-model="data.email" class="form-control" placeholder="Email address to send download link" aria-describedby="nedf-email"></div>',restrict:"AE",link:function(e,n){e.data=t.data,console.log("data"+e.data)}}}]).filter("reviewProductsSelected",function(){return function(t){return t.filter(function(t){return t.selected})}}).factory("reviewService",["$http","clipService","configService","listService","persistService",function(t,i,r,a,o){var s="elvis_download_email",c=a.data,l={data:a.data,get products(){return a.products},startExtract:function(){var o=i.data.clip;return this.setEmail(c.email),r.getConfig("processing").then(function(i){if("POST"===i.method){var r=n(a.products.filter(function(t){return t.selected&&!t.removed}));return r.parameters={xmin:o.xMin,xmax:o.xMax,ymin:o.yMin,ymax:o.yMax,email:c.email},a.products.forEach(function(t){t.selected=t.removed=!1}),t({method:"POST",url:i.postProcessingUrl,data:r,headers:{"Content-Type":"application/json"}}).then(function(t){return{status:"success",message:"Your job has been submitted. An email will be sent on job completion."}},function(t){return{status:"error",message:"Sorry but the service failed to respond. Try again later."}})}var s={json:JSON.stringify(n(a.products.filter(function(t){return t.selected&&!t.removed}))),maxx:o.xMax,maxy:o.yMax,minx:o.xMin,miny:o.yMin,email:c.email};return $("#launcher")[0].src=e(i.processingUrl,s),a.products.forEach(function(t){t.selected=t.removed=!1}),{status:"success",message:"Your job has been submitted. An email will be sent on job completion."}})},removeRemoved:function(){a.products.forEach(function(t){t.removed=!1})},setEmail:function(t){this.data.email=t,o.setItem(s,t)}};return o.getItem(s).then(function(t){l.data.email=t}),l}])}(angular),function(t){t.module("elvis.results.continue",[]).directive("icsmSearchContinue",["continueService",function(t){return{templateUrl:"icsm/results/continue.html",controller:"listCtrl",controllerAs:"ctrl",link:function(e,n){e.data=t.data}}}]).factory("continueService",["listService",function(t){var e={};return e.data=t.data,e}]).filter("someSelected",function(){return function(t){return t&&t.some(function(t){return t.selected})}}).filter("countSelected",function(){return function(t){return t?t.filter(function(t){return t.selected}).length:""}})}(angular),function(t){function e(e){this.service=e,this.checkChildren=function(t){var e=this.childrenChecked(t);t.filter(function(t){return t.matched}).forEach(function(t){e?delete t.selected:t.selected=!0})},this.childrenChecked=function(t){return!t.filter(function(t){return t.matched}).some(function(t){return!t.selected})},this.someMatches=function(e){var n=!1;return t.forEach(e.downloadables,function(e){t.forEach(e,function(t){n|=t.some(function(t){return t.matched})})}),n},this.review=function(){this.service.data.reviewing=!0},this.cancelReview=function(){this.service.data.reviewing=!1}}t.module("elvis.results",["elvis.results.continue"]).directive("icsmOrgHeading",[function(){return{templateUrl:"icsm/results/orgheading.html",restrict:"AE",scope:{org:"=",expansions:"=",mappings:"=",products:"="},link:function(t){t.orgHasSelections=function(){var e=t.org.source;return t.products.some(function(t){return t.source===e&&t.selected})},t.deselectAll=function(){var e=t.org.source;t.products.filter(function(t){return t.source===e&&t.selected}).forEach(function(t){t.selected=!1})}}}}]).directive("icsmList",["$rootScope","listService",function(e,n){return{templateUrl:"icsm/results/results.html",link:function(i){function r(e){return t.isArray(e)||!e?e:e.split(/,\s*/g).map(function(t){return+t})}n.getMappings().then(function(t){i.mappings=t}),i.filters=n.data,i.update=function(){var t=!!i.filters.filter,e=i.filters.types.some(function(t){return t.selected})&&!i.filters.types.every(function(t){return t.selected});if(i.products.forEach(function(e){e.matched=!t}),e&&i.products.forEach(function(t){t.matched=!1,i.filters.types.filter(function(t){return t.selected}).forEach(function(e){e.match&&e.match[t.type]?t.matched=!0:e.noMatch&&!e.noMatch[t.type]&&(t.matched=!0)})}),t){var n=i.filters.filter.toUpperCase(),r=i.products;e&&(r=r.filter(function(t){return t.matched})),r.forEach(function(t){t.matched=t.file_name.toUpperCase().indexOf(n)>-1})}},i.show=function(t){var n=r(t.bbox);e.$broadcast("icsm.bbox.draw",n),console.log("show",n)},i.hide=function(t){e.$broadcast("icsm.bbox.draw",null),console.log("hide")},e.$on("site.selection",function(e,r){i.list=null,i.products=[],i.productsMap=[],r.available_data&&(i.list=r.available_data.filter(function(t){return t.downloadables}),i.list.forEach(function(e){t.forEach(e.downloadables,function(n,r){t.forEach(n,function(t,n){t.forEach(function(t){t.source=e.source,t.group=n,t.type=r,i.productsMap[t.file_url]=t,i.products.push(t)})})})}),n.products=i.products),i.update()}),i.show=function(t){var n=r(t.bbox);e.$broadcast("icsm.bbox.draw",n),console.log("show",n)},i.hide=function(t){e.$broadcast("icsm.bbox.draw",null),console.log("hide")}}}}]).directive("icsmAbstract",["listService",function(t){return{templateUrl:"icsm/results/abstractbutton.html",scope:{item:"="},link:function(e){function n(){e.fetched||(e.fetched=!0,t.getMetadata(e.item.file_name).then(function(t){e.item.metadata=t}))}e.toggle=function(){e.item.showAbstract=!e.item.showAbstract,e.item.showAbstract&&n()}}}}]).directive("icsmAbstractHover",["$timeout","listService",function(t,e){var n=250;return{restrict:"AE",scope:{item:"="},link:function(i,r){function a(){i.fetched||(i.fetched=!0,e.getMetadata(i.item.file_name).then(function(t){i.item.metadata=t}))}var o;r.on("mouseenter",function(){o&&t.cancel(o),o=t(a,n)}),r.on("mouseleave",function(){o&&(t.cancel(o),o=null)})}}}]).directive("icsmAbstractLink",["$timeout","listService",function(t,e){var n="https://s3-ap-southeast-2.amazonaws.com/nsw.elvis/z5${zone}/Metadata/";return{restrict:"AE",template:"<a target='_blank' ng-if='item.source == \"NSW Government\"' ng-href='{{url}}'>{{item.file_name}}</a><span ng-if='item.source != \"NSW Government\"' ng-bind='item.file_name'></span>",scope:{item:"="},link:function(t,e){var i=t.item.file_name,r=/\_5\d\_/,a=i.search(r),o=6,s=n;a!=-1&&(o=i.substr(a+2,1)),t.url=s.replace("${zone}",o)+i.replace(".zip","_Metadata.html")}}}]).controller("listCtrl",e).factory("listService",["$http",function(e){function n(t){var n=/\_5\d\_/,a=t.search(n),o=6,s=i;return a!=-1&&(o=t.substr(a+2,1)),s=s.replace("${zone}",o)+t.replace(".zip","_Metadata.xml"),e.get(s).then(function(t){var e=t.data.MD_Metadata,n={},i=e&&e.identificationInfo&&e.identificationInfo.MD_DataIdentification,a=i;if(i=i&&i.citation&&i.citation&&i.citation.CI_Citation,i=i&&i.title&&i.title.CharacterString){n.title=i.__text;var o=a&&a["abstract"]&&a["abstract"].CharacterString&&a["abstract"].CharacterString.__text;n["abstract"]=n.abstractText=o}else n.title=r;return n},function(t){return{title:r}})}var i="xml2js/https://s3-ap-southeast-2.amazonaws.com/nsw.elvis/z5${zone}/Metadata/",r="No metadata found for this dataset.",a={};return a.data={filter:"",types:[]},e.get("icsm/resources/config/filetypes.json").then(function(e){a.data.typesMap=e.data,a.data.types=[],t.forEach(e.data,function(t,e){a.data.types.push(t)})}),a.getMetadata=function(t){return n(t)},a.getMappings=function(){return e.get("icsm/resources/config/list.json").then(function(t){return t.data})},a}]).filter("allowedTypes",["listService",function(e){return function(n){if(!e.data.types.some(function(t){return t.selected}))return n;var i={};return t.forEach(n,function(t,n){e.data.typesMap&&e.data.typesMap[n]&&e.data.typesMap[n].selected&&(i[n]=t)}),console.log(i),i}}]).filter("countMatchedDownloadables",function(){return function(e){if(e){var n=0;return t.forEach(e,function(e,i){t.forEach(e,function(t){n+=t.filter(function(t){return t.matched}).length})}),n}return"-"}}).filter("matchedTypes",function(){listService.data;return function(e){var n={};return t.forEach(e,function(t,e){t.some(function(t){return t.matched})&&(n[e]=t)}),n}}).filter("matchedGroups",["listService",function(e){return function(e){var n={};return e&&t.forEach(e,function(t,e){t.some(function(t){return t.matched})&&(n[e]=t)}),n}}]).filter("matchedItems",["listService",function(t){return function(t){return t.filter(function(t){return t.matched})}}]).filter("countDownloadables",function(){return function(e){if(e){var n=0;return t.forEach(e,function(e,i){t.forEach(e,function(t,e){n+=t.length})}),n}return"-"}}).filter("fileSize",function(){var t=1e6,e=1e3*t,n=1e3*e;return function(i){return i?(""+i).indexOf(" ")>-1?i:(i=parseFloat(i),i<1e3?i+" bytes":i<t?(i/1e3).toFixed(1)+" kB":i<e?(i/t).toFixed(1)+" MB":i<n?(i/e).toFixed(1)+" GB":(i/n).toFixed(1)+" TB"):"-"}}),e.$inject=["listService"],e.prototype={get products(){return this.service.products},get selectedSize(){var t=this.service.products;return(t?t.filter(function(t){return t.selected&&!t.removed}):[]).map(function(t){return t.file_size?+t.file_size:5e8}).reduce(function(t,e){return t+e},0)},get selected(){var t=this.service.products;return t?t.filter(function(t){return t.selected&&!t.removed}):[]}}}(angular),function(t){function e(t,e,i,r,a,o){function s(){r(function(){f._executeQuery()},100)}var c,l="Search Layers",d="icsm/resources/config/select.json",u={text:"",daterange:{enabled:!1,upper:null,lower:null},bbox:{fromMap:!0,intersects:!0,yMax:null,yMin:null,xMax:null,xMin:null},defaultKeywords:[],keywords:[]},p={},m="#ff7800",h="darkblue",f={getSelectCriteria:function(){return u},getLayerGroup:function(){return c||(c=a.getGroup(l)),c},setKeywords:function(t){},setFilter:function(t){},refresh:function(){},getDaterange:function(){return u.daterange},more:function(){},_executeQuery:function(){t.get(d,{cache:!0}).then(function(t){f.getLayerGroup();var e=t.data;e.response.docs.forEach(function(t){f._decorateDataset(t),"group"==t.type&&t.docs.forEach(function(t){f._decorateDataset(t)})}),i.$broadcast("select.facet.counts",e),i.$broadcast("select.results.received",e)})},createLayer:function(t,e){var n,i,r,a=t.bbox,o=t.primaryId;if(r=p[o],!r){if(!a)return null;if(n=a.split(" "),4!=n.length)return null;e||(e=m),i=[[+n[1],+n[0]],[+n[3],+n[2]]],r=L.rectangle(i,{fill:!1,color:"#000000",width:3,clickable:!1}),p[o]=r}return this._decorateDataset(t),c.addLayer(r),r},_decorateDataset:function(t){function e(t){var e;return t?(e=t.split(/\s/g),{xMin:+e[0],xMax:+e[2],yMax:+e[3],yMin:+e[1]}):null}var i=p[t.primaryId];i?(t.layer=i,t.showLayer=!0):(t.layer=null,t.showLayer=!1,t.services=n(t.dcUris),t.bounds=e(t.bbox))},showWithin:function(t){function e(t,e,n,i){var r=u.bbox;return t>r.xMin&&n<r.xMax&&e>r.yMin&&i<r.yMax}t.forEach(function(t){var n,i=t.bbox;i?(n=i.split(" "),4==n.length&&e(+n[0],+n[1],+n[2],+n[3])?f.createLayer(t):f.removeLayer(t)):f.removeLayer(t)})},toggle:function(t){t.showLayer?this.removeLayer(t):this.createLayer(t)},toggleAll:function(t){var e=this,n=t.some(function(t){return!t.showLayer});return t.forEach(function(t){n?t.showLayer||e.createLayer(t):t.showLayer&&e.removeLayer(t)}),!n},hideAll:function(t){t.forEach(function(t){t.showLayer&&f.removeLayer(t)})},hilight:function(t){t.setStyle({color:h})},lolight:function(t){t.setStyle({color:m})},removeLayer:function(t){var e=t.primaryId,n=p[e];n&&(c.removeLayer(n),delete p[e]),this._decorateDataset(t)}};return s(),f}function n(t){function e(t){this.uris=t,this.container={wcs:null,wms:null},t?this.services=t.map(function(t){var e=new n(t);return this.container.wcs=e.isWcs()?e:this.container.wcs,this.container.wms=e.isWms()?e:this.container.wms,e}.bind(this)):this.services=[],this.hasWcs=function(){return null!==this.container.wcs},this.hasWms=function(){return null!==this.container.wms},this.getWcs=function(){return this.container.wcs},this.getWms=function(){return this.container.wms},this.remove=function(){this.services.forEach(function(t){t.remove()})}}function n(t){var e=$(t);this.protocol=e.attr("protocol"),this.url=e.text(),this.layerNames=e.attr("layerNames"),this.name=e.attr("name"),this.description=e.attr("description"),this.handlers=[],this.isWcs=function(){return this.protocol==i.WCS},this.isWfs=function(){return this.protocol==i.WFS},this.isWms=function(){return this.protocol==i.WMS},this.isSupported=function(){return"undefined"==typeof i[this.protocol]},this.addHandler=function(t){this.handlers.push(t)},this.removeHandler=function(t){this.handlers.push(t)},this.remove=function(){this.handlers.forEach(function(t){this.callback.remove&&t.remove(this)}.bind(this)),this.handlers=[]}}var i={WCS:"OGC:WCS",WFS:"OGC:WFS",WMS:"OGC:WMS"};return new e(t)}t.module("icsm.select.service",[]).factory("selectService",e),e.$inject=["$http","$q","$rootScope","$timeout","mapService","configService"]}(angular),function(t){function e(t){this.criteria=t.getSelectCriteria(),this.refresh=function(){t.refresh()}}function n(t,e,n,i){var r,a=this;t.$on("select.results.received",function(t,e){n.remove(r),a.data=e}),e.getConfig("facets").then(function(t){this.hasKeywords=t&&t.keywordMapped&&t.keywordMapped.length>0}.bind(this)),this.select=function(){n.remove(r),r=n.add("Selecting",3e3,!0),i.setFilter(this.filter)},this.toggle=function(t){i.toggle(t)},this.toggleAll=function(){i.toggleAll(this.data.response.docs)},this.showWithin=function(){i.showWithin(this.data.response.docs)},this.allShowing=function(){return!(!this.data||!this.data.response)&&!this.data.response.docs.some(function(t){return!t.showLayer})},this.anyShowing=function(){return!(!this.data||!this.data.response)&&this.data.response.docs.some(function(t){return t.showLayer})},this.hideAll=function(){i.hideAll(this.data.response.docs)},this.hilight=function(t){t.layer&&i.hilight(t.layer)},this.lolight=function(t){t.layer&&i.lolight(t.layer)}}t.module("icsm.select",["icsm.select.service"]).controller("SelectCtrl",n).controller("SelectCriteriaCtrl",e).directive("icsmSelect",[function(){return{templateUrl:"icsm/select/select.html",link:function(t,e,n){console.log("Hello select!")}}}]).directive("selectDoc",[function(){return{templateUrl:"icsm/select/doc.html",link:function(t,e,n){console.log("What's up doc!")}}}]).directive("selectGroup",[function(){return{templateUrl:"icsm/select/group.html",scope:{group:"="},link:function(t,e,n){console.log("What's up doc!")}}}]).filter("pubDate",function(){return function(t){var e;return t?(e=new Date(t),e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()):"-"}}).filter("authors",function(){return function(t){return t?t.join(", "):"-"}}).filter("truncate",function(){return function(t,e){return t&&t.length>e-3?t.substr(0,e-3)+"...":t}}),e.$inject=["selectService"],n.$inject=["$rootScope","configService","flashService","selectService"]}(angular),function(t){t.module("icsm.splash",[]).directive("icsmSplash",["$rootScope","$uibModal","$log","splashService",function(t,e,n,i){return{controller:["$scope","splashService",function(t,e){t.acceptedTerms=!0,e.getReleaseNotes().then(function(n){t.releaseMessages=n,t.acceptedTerms=e.hasViewedSplash()})}],link:function(r,a){var o;r.$watch("acceptedTerms",function(t){t===!1&&(o=e.open({templateUrl:"icsm/splash/splash.html",size:"lg",backdrop:"static",keyboard:!1,controller:["$scope","$uibModalInstance","acceptedTerms","messages",function(t,e,n,i){t.acceptedTerms=n,t.messages=i,t.accept=function(){e.close(!0)}}],resolve:{acceptedTerms:function(){return r.acceptedTerms},messages:function(){return r.releaseMessages}}}),o.result.then(function(t){n.info("Accepted terms"),r.acceptedTerms=t,i.setHasViewedSplash(t)},function(){n.info("Modal dismissed at: "+new Date)}))}),t.$on("logoutRequest",function(){userService.setAcceptedTerms(!1)})}}}]).factory("splashService",["$http",function(t){function e(t){t?sessionStorage.setItem(i,!0):sessionStorage.removeItem(i)}function n(){return!!sessionStorage.getItem(i)}var i="icsm.accepted.terms",r="icsm/resources/service/releaseNotes";return{getReleaseNotes:function(){return t({method:"GET",url:r+"?t="+Date.now()}).then(function(t){return t.data})},hasViewedSplash:n,setHasViewedSplash:e}}]).filter("priorityColor",[function(){var t={IMPORTANT:"red",HIGH:"blue",MEDIUM:"orange",LOW:"gray"};return function(e){return e in t?t[e]:"black"}}]).filter("wordLowerCamel",function(){return function(t){return t.charAt(0)+t.substr(1).toLowerCase()}}).filter("sortNotes",[function(){return function(t){if(t){var e=t.slice(0).sort(function(t,e){return t.priority==e.priority?t.lastUpdate==e.lastUpdate?0:e.lastUpdate-t.lastUpdate:"IMPORTANT"==t.priority?-11:1});return e}}}])}(angular),function(t){t.module("icsm.themes",[]).directive("icsmThemes",["themesService",function(t){return{restrict:"AE",templateUrl:"icsm/themes/themes.html",link:function(e){t.getThemes().then(function(t){e.themes=t}),t.getCurrentTheme().then(function(t){e.theme=t}),e.changeTheme=function(n){e.theme=n,t.setTheme(n.key)}}}}]).controller("themesCtrl",["themesService",function(t){this.service=t}]).filter("themesFilter",function(){return function(t,e){var n=[];return e?(t&&t.forEach(function(t){t.themes&&t.themes.some(function(t){return t==e.key})&&n.push(t)}),n):t}}).factory("themesService",["$q","configService","storageService",function(e,n,i){var r="icsm.current.theme",a="All",o=[],s=this;return this.themes=[],this.theme=null,i.getItem(r).then(function(e){e||(e=a),n.getConfig("themes").then(function(n){s.themes=n,s.theme=n[e],t.forEach(n,function(t,e){t.key=e}),o.forEach(function(t){t.resolve(s.theme)})})}),this.getCurrentTheme=function(){if(this.theme)return e.when(s.theme);var t=e.defer();return o.push(t),t.promise},this.getThemes=function(){return n.getConfig("themes")},this.setTheme=function(t){this.theme=this.themes[t],i.setItem(r,t)},this}])}(angular),function(t){t.module("icsm.state",[]).directive("icsmStateToggle",["downloadService",function(t){return{restrict:"AE",template:'<button ng-click="toggle(false)" ng-disabled="state.show" class="btn btn-default" title="Start downlaod selection."><i class="fa fa-lg fa-object-group"></i></button>',link:function(e){t.data().then(function(t){e.state=t}),e.toggle=function(){e.state.show=!e.state.show}}}}])}(angular),function(t){t.module("icsm.toolbar",[]).directive("icsmToolbar",[function(){return{controller:"toolbarLinksCtrl"}}]).directive("icsmToolbarRow",[function(){
return{scope:{map:"="},restrict:"AE",templateUrl:"icsm/toolbar/toolbar.html"}}]).directive("icsmToolbarInfo",[function(){return{templateUrl:"radwaste/toolbar/toolbarInfo.html"}}]).controller("toolbarLinksCtrl",["$scope","configService",function(t,e){var n=this;e.getConfig().then(function(t){n.links=t.toolbarLinks}),t.item="",t.toggleItem=function(e){t.item=t.item===e?"":e}}])}(angular),function(t,e){function n(t){t.data().then(function(t){this.data=t}.bind(this)),this.remove=function(){t.clear()},this.changeEmail=function(e){t.setEmail(e)}}function i(t,e,n,i,r){var a="download_email",o="Download Layers",s={zoom:null,center:null,layer:null},c=null,l={getLayerGroup:function(){return i.getGroup(o)},setState:function(t){function e(){[[t.bounds.yMin,t.bounds.xMin],[t.bounds.yMax,t.bounds.xMax]];s.layer&&i.getGroup(o).removeLayer(s.layer)}function n(t){s.layer&&(i.clearGroup(o),s.layer=null)}t?e():n()},decorate:function(){var t=c.item;c.item.download=!0,t.processsing||(t.processing={clip:{xMax:null,xMin:null,yMax:null,yMin:null}})},setEmail:function(t){r.setItem(a,t)},getEmail:function(){return r.getItem(a).then(function(t){return c.email=t,t})},data:function(){return c?e.when(c):t.get("icsm/resources/config/icsm.json").then(function(t){return c=t.data,l.decorate(),c})}};return l}t.module("icsm.view",[]).directive("icsmView",["downloadService",function(t){return{templateUrl:"icsm/view/view.html",controller:"DownloadCtrl",link:function(e,n){t.data().then(function(t){e.data=t}),e.$watch("data.item",function(e,n){(e||n)&&t.setState(e)})}}}]).controller("DownloadCtrl",n).factory("downloadService",i),n.$inject=["downloadService"],i.$inject=["$http","$q","$rootScope","mapService","storageService"]}(angular,$),angular.module("icsm.templates",[]).run(["$templateCache",function(t){t.put("icsm/app/app.html",'<div>\r\n\t<!-- BEGIN: Sticky Header -->\r\n\t<div explorer-header style="z-index:1"\r\n\t\t\tclass="navbar navbar-default navbar-fixed-top"\r\n\t\t\theading="\'ELVIS - Foundation Spatial Data\'"\r\n\t\t\theadingtitle="\'ICSM\'"\r\n\t\t\tbreadcrumbs="[{name:\'ICSM\', title: \'Reload ELVIS - Foundation Spatial Data\', url: \'.\'}]"\r\n\t\t\thelptitle="\'Get help about ELVIS - Foundation Spatial Data\'"\r\n\t\t\thelpalttext="\'Get help about ELVIS - Foundation Spatial Data\'">\r\n\t</div>\r\n\t<!-- END: Sticky Header -->\r\n\r\n\t<!-- Messages go here. They are fixed to the tab bar. -->\r\n\t<div explorer-messages class="marsMessages noPrint"></div>\r\n\t<icsm-panes data="root.data" default-item="download"></icsm-panes>\r\n</div>'),t.put("icsm/clip/clip.html",'<div class="well well-sm">\r\n\t<div class="container-fluid">\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-12">\r\n\t\t\t\t<div class="btn-group" role="group" aria-label="...">\r\n\t\t\t\t\t<button ng-click="initiateDraw()" ng-disable="client.drawing" tooltip-placement="bottom" uib-tooltip="Enable drawing of a bounding box. On enabling, click on the map and drag diagonally"\r\n\t\t\t\t\t\tclass="btn btn-primary btn-default">Select an area...</button>\r\n\t\t\t\t\t<button ng-click="typing = !typing" tooltip-placement="bottom" uib-tooltip="Type coordinates of a bounding box. Restricted to maximum of 2x2 degrees."\r\n\t\t\t\t\t\tclass="btn btn-primary btn-default">Manual entry...</button>\r\n\t\t\t\t\t<button ng-click="showInfo = !showInfo" tooltip-placement="bottom" uib-tooltip="Information." class="btn btn-primary btn-default"><i class="fa fa-info"></i></button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<exp-info title="Selecting an area" show-close="true" style="width:450px;position:fixed;top:230px;right:40px" is-open="showInfo">\r\n\t\t\t\t\t<icsm-info-bbox></icsm-info-bbox>\r\n\t\t\t\t</exp-info>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-show="oversize" style="margin-top:15px">\r\n\t\t\t<div class="alert alert-danger" role="alert">Please restrict the size of your selected area to no more than 4 square degrees.</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="row" ng-hide="!clip.xMin && clip.xMin != 0" style="padding-top:7px;">\r\n\t\t\t<div class="col-md-12">\r\n\t\t\t\tSelected {{clip.xMin|number : 4}}&deg; west, {{clip.yMax|number : 4}}&deg; north, {{clip.yMax|number : 4}}&deg; east, {{clip.xMin|number\r\n\t\t\t\t: 4}}&deg; south\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="container-fluid" style="padding-top:7px" ng-show="typing">\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-3"> </div>\r\n\t\t\t<div class="col-md-8">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">Y Max:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.yMax" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.yMax|number : 4}} max)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">X Min:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.xMin" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.xMin|number : 4}} min)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">X Max:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.xMax" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.xMax|number : 4}} max)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-offset-3 col-md-8">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">Y Min:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.yMin" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.yMin|number : 4}} min)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/clip/infobbox.html",'<div class="">\r\n\t<strong style="font-size:120%">Select an area of interest.</strong> There are two ways to select your area of interest:\r\n\t<ol>\r\n\t\t<li>By hitting the "Draw" button an area on the map can be selected with the mouse by clicking a\r\n         corner and while holding the left mouse button\r\n\t\t\tdown drag diagonally across the map to the opposite corner or</li>\r\n\t\t<li>By hitting the "Manual entry" button which shows inputs to allow the entry of coordinates. .</li>\r\n\t</ol>\r\n\tOnce drawn the points can be modified by the overwriting the values manually or drawing another area by\r\n   clicking the "Draw" button again. <br/>\r\n\t<strong>Notes:</strong>\r\n   <ul>\r\n      <li>The data does not cover all of Australia.</li>\r\n      <li>Restrict a search area to below four square degrees. eg 2x2 or 1x4</li>\r\n   </ul>\r\n\t<p style="padding-top:5px"><strong>Hint:</strong> If the map has focus, you can use the arrow keys to pan the map.\r\n\t\tYou can zoom in and out using the mouse wheel or the "+" and "-" map control on the top left of the map. If you\r\n\t\tdon\'t like the position of your drawn area, hit the "Draw" button and draw a new bounding box.\r\n\t</p>\r\n</div>'),t.put("icsm/glossary/glossary.html",'<div ng-controller="GlossaryCtrl as glossary">\r\n\t<div style="position:relative;padding:5px;padding-left:10px;" >\r\n\t\t<div class="panel panel-default" style="padding:5px;" >\r\n\t\t\t<div class="panel-heading">\r\n\t\t\t\t<h3 class="panel-title">Glossary</h3>\r\n\t\t\t</div>\r\n\t\t\t<div class="panel-body">\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t<table class="table table-striped">\r\n\t\t<thead>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>Term</th>\r\n\t\t\t\t<th>Definition</th>\r\n\t\t\t</tr>\r\n\t\t</thead>\r\n\t\t<tbody>\r\n\t\t\t<tr ng-repeat="term in glossary.terms">\r\n\t\t\t\t<td>{{term.term}}</td>\r\n\t\t\t\t<td>{{term.definition}}</td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table>\r\n</div>\r\n</div>\r\n</div>'),t.put("icsm/header/header.html",'<div class="container-full common-header" style="padding-right:10px; padding-left:10px">\r\n    <div class="navbar-header">\r\n\r\n        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".ga-header-collapse">\r\n            <span class="sr-only">Toggle navigation</span>\r\n            <span class="icon-bar"></span>\r\n            <span class="icon-bar"></span>\r\n            <span class="icon-bar"></span>\r\n        </button>\r\n\r\n        <a href="http://www.ga.gov.au" class="hidden-xs header-logo">\r\n            <img src="icsm/resources/img/Geoscience Australia.jpg" alt="Geoscience Australia" class="elvis-logo"></img>\r\n            <img src="icsm/resources/img/NSW.jpg" alt="NSW Land $amp;Property Information" class="elvis-logo"></img>\r\n            <img src="icsm/resources/img/logo-ACT.jpg" alt="ACT Government" class="elvis-logo"></img>\r\n         </a>\r\n        <a href="http://www.ga.gov.au" class="visible-xs"><img src="icsm/resources/img/icsm-logo-sml.gif" alt="ICSM - ANZLIC Committee on Surveying &amp; Mapping" class="logo-stacked"></img></a>\r\n        <a href="/" class="appTitle visible-xs"><h1 style="font-size:120%">{{heading}}</h1></a>\r\n    </div>\r\n    <div class="navbar-collapse collapse ga-header-collapse">\r\n        <ul class="nav navbar-nav">\r\n            <li class="hidden-xs"><a href="/"><h1 class="applicationTitle">{{heading}}</h1></a></li>\r\n        </ul>\r\n        <ul class="nav navbar-nav navbar-right nav-icons">\r\n        \t<li common-navigation ng-show="username" role="menuitem" style="padding-right:10px"></li>\r\n\t\t\t<li mars-version-display role="menuitem"></li>\r\n\t\t\t<li style="width:10px"></li>\r\n        </ul>\r\n    </div><!--/.nav-collapse -->\r\n</div>\r\n\r\n<!-- Strap -->\r\n<div class="row">\r\n    <div class="col-md-12">\r\n        <div class="strap-blue">\r\n        </div>\r\n        <div class="strap-white">\r\n        </div>\r\n        <div class="strap-red">\r\n        </div>\r\n    </div>\r\n</div>'),t.put("icsm/help/faqs.html",'<div class="container" style="width:100%;border: 1px solid lightgray">\r\n\t<p style="text-align: left; margin: 10px; font-size: 14px;">\r\n\t\t<strong>FAQS</strong>\r\n\t</p>\t\r\n\r\n\t<h5 ng-repeat="faq in faqs"><button type="button" class="undecorated" ng-click="focus(faq.key)">{{faq.question}}</button></h5>\r\n\t<hr/>\r\n\t<div class="row" ng-repeat="faq in faqs">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<h5 tabindex="0" id="faqs_{{faq.key}}">{{faq.question}}</h5>\r\n\t\t\t<span ng-bind-html="faq.answer"></span>\r\n\t\t\t<hr/>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/help/help.html",'<div ng-controller="HelpCtrl as help">\r\n\t<div style="position:relative;padding:5px;padding-left:10px;" >\r\n\t\t<div class="panel panel-default" style="padding:5px;" >\r\n\t\t\t<div class="panel-heading">\r\n\t\t\t\t<h3 class="panel-title">Help</h3>\r\n\t\t\t</div>\r\n\t\t\t<div class="panel-body">\r\n\t\t\t\tThe steps to get data!\r\n\t\t\t\t<ol>\r\n\t\t\t\t\t<li>Select dataset of interest <i class="fa fa-download"></i> from Select tab</li>\r\n\t\t\t\t\t<li>Define area</li>\r\n\t\t\t\t\t<li>Select output format</li>\r\n\t\t\t\t\t<li>Select coordinate system</li>\r\n\t\t\t\t\t<li>Enter email address</li>\r\n\t\t\t\t\t<li>Submit entries</li>\r\n\t\t\t\t</ol>\r\n\t\t\t\tAn email will be sent to you on completion of the data extract with a link to your data.\r\n\t\t\t\t<icsm-faqs faqs="help.faqs" ></icsm-faqs>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/panes/panes.html",'<div class="container contentContainer">\r\n\t<div class="row icsmPanesRow" >\r\n\t\t<div class="icsmPanesCol" ng-class="{\'col-md-12\':!view, \'col-md-7\':view}" style="padding-right:0">\r\n\t\t\t<div class="expToolbar row noPrint" icsm-toolbar-row map="root.map"></div>\r\n\t\t\t<div class="panesMapContainer" geo-map configuration="data.map">\r\n\t\t\t    <geo-extent></geo-extent>\r\n\t\t\t    <common-feature-info></common-feature-info>\r\n\t\t\t    <icsm-layerswitch></icsm-layerswitch>\r\n\t\t\t</div>\r\n    \t\t<div geo-draw data="data.map.drawOptions" line-event="elevation.plot.data" rectangle-event="bounds.drawn"></div>\r\n    \t\t<div class="common-legend" common-legend map="data.map"></div>\r\n    \t\t<div icsm-tabs class="icsmTabs"  ng-class="{\'icsmTabsClosed\':!view, \'icsmTabsOpen\':view}"></div>\r\n\t\t</div>\r\n\t\t<div class="icsmPanesColRight" ng-class="{\'hidden\':!view, \'col-md-5\':view}" style="padding-left:0; padding-right:0">\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'download\'" icsm-view></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'maps\'" icsm-maps></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'glossary\'" icsm-glossary></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'help\'" icsm-help></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/panes/tabs.html",'<!-- tabs go here -->\r\n<div id="panesTabsContainer" class="paneRotateTabs" style="opacity:0.9" ng-style="{\'right\' : contentLeft +\'px\'}">\r\n\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'download\'}" ng-click="setView(\'download\')">\r\n\t\t<button class="undecorated">Download</button>\r\n\t</div>\r\n\t<!-- \r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'search\'}" ng-click="setView(\'search\')">\r\n\t\t<button class="undecorated">Search</button>\r\n\t</div>\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'maps\'}" ng-click="setView(\'maps\')">\r\n\t\t<button class="undecorated">Layers</button>\r\n\t</div>\r\n\t-->\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'glossary\'}" ng-click="setView(\'glossary\')">\r\n\t\t<button class="undecorated">Glossary</button>\r\n\t</div>\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'help\'}" ng-click="setView(\'help\')">\r\n\t\t<button class="undecorated">Help</button>\r\n\t</div>\r\n</div>\r\n'),t.put("icsm/reviewing/reviewing.html",'<div class="modal-header">\r\n\t<h3 class="modal-title splash">Review datasets, provide email and continue</h3>\r\n</div>\r\n<div class="modal-body" id="accept" ng-form exp-enter="accept()" icsm-splash-modal style="width: 100%; margin-left: auto; margin-right: auto;">\r\n\t<div class="row bg-warning" ng-show="noneSelected(products)">\r\n\t\t<div class="col-md-10 center-block" style="padding:5px; text-align:center">\r\n\t\t\t<strong>All datasets have been removed.</strong>\r\n\t\t</div>\r\n\t\t<div class="col-md-2">\r\n\t\t\t<button type="button" style="float:right" class="btn btn-primary" ng-click="cancel()">Close</button>\r\n\t\t</div>\r\n\t</div>\r\n\t<div ng-hide="noneSelected(products)" ng-controller="listCtrl as list" >\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-12">\r\n\t\t\t\t<h4>{{list.selected.length}} Selected Datasets   <span ng-show="list.selectedSize">(Approx: {{list.selectedSize | fileSize}})</span></h4>\r\n\t\t\t\tReview and delete unwanted datasets.\r\n\t\t\t</div>\r\n\t\t</div>\r\n      <div class="reviewing-datasets">\r\n\t\t   <div class="row" ng-repeat="product in products | reviewProductsSelected"  ng-class-odd="\'reviewing-odd\'">\r\n\t\t\t   <div class="col-md-7">\r\n\t\t\t\t   <button type="button" class="btn btn-default btn-xs" ng-click="product.removed = !product.removed">\r\n                  <i class="fa fa-2x" ng-class="{\'fa-times-circle\': product.removed, \'fa-check-circle\': !product.removed}" aria-hidden="true"></i>\r\n               </button>\r\n               <span style="padding-left:7px" ng-class="{\'exclude\': product.removed}">{{product.file_name}}</span>\r\n\t\t\t   </div>\r\n\t\t\t   <div class="col-md-4" style="padding:6px">\r\n\t\t\t\t   ({{product.source}}\r\n\t\t\t\t   <i class="fa fa-arrow-right" aria-hidden="true"></i> {{product.type}}\r\n\t\t\t\t   <i class="fa fa-arrow-right" aria-hidden="true"></i> {{product.group}})\r\n\t\t\t   </div>\r\n\t\t\t   <div class="col-md-1" style="padding:6px">\r\n\t\t\t   \t{{product.file_size | fileSize}}\r\n\t\t\t   </div>\r\n\t\t   </div>\r\n      </div>\r\n\t</div>\r\n   <div class="row reviewing-divider">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<p>\r\n\t\t\t\t<strong>Email notification</strong> The extract of data can take some time. By providing an email address we will be\r\n\t\t\t\table to notify you when the job is complete. The email will provide a link to the extracted data which will be packaged\r\n\t\t\t\tup as a single compressed file.\r\n\t\t\t</p>\r\n\t\t\t<div review-email></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="row" ng-controller="listCtrl as list">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<div class="pull-right" style="padding:8px;">\r\n\t\t\t\t<button type="button" class="btn btn-primary" ng-click="accept()" ng-disabled="!data.email || !list.selected.length">Start extract of datasets\r\n\r\n              </button>\r\n\t\t\t\t<button type="button" class="btn btn-primary" ng-click="cancel()">Cancel</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/results/abstractbutton.html",'<button type="button" class="undecorated" title="View Full title and abstract of this dataset" ng-click="toggle()">\r\n\t<i class="fa fa-lg" ng-class="{\'fa-caret-down active\':item.showAbstract, \'fa-caret-right\':!item.showAbstract}"></i>\r\n</button>'),t.put("icsm/results/abstracttooltip.html","<div>\r\n{{item.metadata.title? item.metadata.title: 'Loading...'}}\r\n</div>"),t.put("icsm/results/continue.html",'<div class="continue-container" ng-show="ctrl.selected.length">\r\n   <button class="btn btn-primary" ng-click="ctrl.review()">Review {{ctrl.selected.length}} selected datasets (Approx: {{ctrl.selectedSize | fileSize}})</button>\r\n</div>\r\n\r\n'),t.put("icsm/results/orgheading.html",'<h5>\r\n\t<button class="undecorated" ng-click="expansions[org.source] = !expansions[org.source]"\r\n      uib-tooltip="Click to collapse/expand this group" tooltip-append-to-body="true"\r\n\t\taria-expanded="true" aria-controls="collapse{{mappings[org.source].code}}">\r\n      <img ng-src="{{mappings[org.source].image}}" ng-attr-style="height:{{mappings[org.source].height}}px"></img>\r\n      <strong>{{org.source}}</strong> (Showing {{org.downloadables | countMatchedDownloadables}} of {{org.downloadables\t| countDownloadables}})\r\n   </button>\r\n\t<span class="listTopExpander">\r\n      <button class="undecorated" ng-show="orgHasSelections()" ng-click="deselectAll()">\r\n         [Deselect all]\r\n      </button>\r\n      <button class="undecorated" ng-click="expansions[org.source] = !expansions[org.source]">\r\n         [{{expansions[org.source]?"collapse":"expand"}}]\r\n      </button>\r\n   </span>\r\n</h5>'),t.put("icsm/results/results.html",'<div ng-show="!list || !list.length">\r\n   <div class="alert alert-warning" role="alert"><strong>Select an area</strong> to find datasets within.</div>\r\n</div>\r\n\r\n<div ng-show="list.length">\r\n   <div class="row">\r\n      <div class="col-md-5" uib-tooltip="Number of intersecting or very near datasets to your area of interest.">\r\n         <h4 style="display:inline-block">Found {{products.length}} datasets</h4>\r\n      </div>\r\n      <div class="col-md-7">\r\n         <div class="input-group input-group-sm">\r\n            <span class="input-group-addon" id="names1">Filter:</span>\r\n            <input type="text" ng-model="filters.filter" class="form-control" ng-change="update()" placeholder="Filter names" aria-describedby="names1">\r\n         </div>\r\n      </div>\r\n   </div>\r\n   <div class="panel panel-default">\r\n      <div class="panel-body" style="float:clear">\r\n         <span style="padding:10px; float:left">\r\n\t\t\t\t<span class="listTypeLabel">Filter by type:</span>\r\n         <span ng-repeat="type in filters.types" class="listType">\r\n               <input type="checkbox" ng-model="type.selected" ng-change="update()"/>\r\n               <span uib-tooltip="{{type.description}}">{{type.label}}</span>\r\n         </span>\r\n         </span>\r\n         <span style="float:right">\r\n            <icsm-search-continue></icsm-search-continue>\r\n         </span>\r\n      </div>\r\n   </div>\r\n\r\n   <div ng-repeat="available in list" class="well" style="padding-left:4px;padding-right:4px" ng-show="list.someMatches(available)"\r\n      ng-controller="listCtrl as list">\r\n      <icsm-org-heading org="available" expansions="expansions" mappings="mappings" products="products"></icsm-org-heading>\r\n      <div uib-collapse="!expansions[available.source]">\r\n         <div class="listRow" ng-class-odd="\'listEven\'" ng-repeat="(typeKey, types) in available.downloadables | allowedTypes">\r\n            <h5><strong>{{typeKey}}</strong></h5>\r\n            <div ng-repeat="(key, items) in types">\r\n               <div>\r\n                  <h5>\r\n                     <button ng-click="list.checkChildren(items)" style="width:7em" class="btn btn-xs btn-default">\r\n                        <span ng-show="!list.childrenChecked(items)">Select all</span>\r\n                        <span ng-show="list.childrenChecked(items)">Deselect all</span>\r\n                  </button>\r\n                     <strong uib-tooltip="{{filter.types[key].description}}">{{key}}</strong>\r\n                  </h5>\r\n                  <div ng-repeat="item in items | matchedItems" icsm-abstract-hover item="item" >\r\n                     <div tooltip-append-to-body="true" uib-tooltip-template="\'icsm/results/abstracttooltip.html\'" tooltip-popup-delay="400"\r\n                              data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                        <input type="checkbox" ng-model="item.selected" />\r\n                        <icsm-abstract item="item" ng-if="item.source == \'NSW Government\'"></icsm-abstract>\r\n                        <common-cc version="mappings[item.source].ccLicence"></common-cc>\r\n                        <span class="listItem" item="item" icsm-abstract-link></span>\r\n                        <span style="float:right;padding-top:3px">({{item.file_size | fileSize}})</span>\r\n                     </div>\r\n                     <div ng-if="item.source == \'NSW Government\'" ng-show="item.showAbstract" class="well">\r\n                        <span ng-show="!item.metadata">\r\n                           <i class="fa fa-spinner fa-spin fa-lg fa-fw"></i>\r\n                           <span>Loading metadata...</span>\r\n                        </span>\r\n                        <div ng-show="item.metadata.abstract">\r\n                           <strong>{{item.metadata.title}}</strong> -\r\n                           <span class="icsm-abstract-body" ng-bind-html="item.metadata.abstractText"></span >\r\n                        </div>\r\n                        <div ng-show="!item.metadata.abstract">\r\n                           <i class="fa fa-lg fa-exclamation-triangle" style="color:orange"></i>\r\n                           There is no abstract available for this dataset.\r\n                        </div>\r\n                     </div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style="text-align:right"><button class="undecorated" ng-click="expansions[available.source] = false">[collapse]</button></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/select/doc.html",'<div ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-mouseleave="select.lolight(doc)" ng-mouseenter="select.hilight(doc)">\r\n\t<span ng-class="{ellipsis:!expanded}" tooltip-enable="!expanded" style="width:100%;display:inline-block;" \r\n\t\t\ttooltip-class="selectAbstractTooltip" tooltip="{{doc.abstract | truncate : 250}}" tooltip-placement="bottom">\r\n\t\t<button type="button" class="undecorated" ng-click="expanded = !expanded" title="Click to see more about this dataset">\r\n\t\t\t<i class="fa pad-right fa-lg" ng-class="{\'fa-caret-down\':expanded,\'fa-caret-right\':(!expanded)}"></i>\r\n\t\t</button>\r\n\t\t<download-add item="doc" group="group"></download-add>\r\n\t\t<icsm-wms data="doc"></icsm-wms>\r\n\t\t<icsm-bbox data="doc" ng-if="doc.showExtent"></icsm-bbox>\r\n\t\t<a href="http://www.ga.gov.au/metadata-gateway/metadata/record/{{doc.sysId}}" target="_blank" ><strong>{{doc.title}}</strong></a>\r\n\t</span>\r\n\t<span ng-class="{ellipsis:!expanded}" style="width:100%;display:inline-block;padding-right:15px;">\r\n\t\t{{doc.abstract}}\r\n\t</span>\r\n\t<div ng-show="expanded" style="padding-bottom: 5px;">\r\n\t\t<h5>Keywords</h5>\r\n\t\t<div>\r\n\t\t\t<span class="badge" ng-repeat="keyword in doc.keywords track by $index">{{keyword}}</span>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/select/group.html",'<div class="panel panel-default" style="margin-bottom:-5px;" >\r\n\t<div class="panel-heading"><icsm-wms data="group"></icsm-wms> <strong>{{group.title}}</strong></div>\r\n\t<div class="panel-body">\r\n   \t\t<div ng-repeat="doc in group.docs">\r\n   \t\t\t<div select-doc doc="doc" group="group"></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n'),t.put("icsm/select/select.html",'<div>\r\n\t<div style="position:relative;padding:5px;padding-left:10px;" ng-controller="SelectCtrl as select" class="scrollPanel">\r\n\t\t<div class="panel panel-default" style="margin-bottom:-5px">\r\n  \t\t\t<div class="panel-heading">\r\n  \t\t\t\t<h3 class="panel-title">Available datasets</h3>\r\n  \t\t\t</div>\r\n  \t\t\t<div class="panel-body">\r\n\t\t\t\t<div ng-repeat="doc in select.data.response.docs" style="padding-bottom:7px">\r\n\t\t\t\t\t<div select-doc ng-if="doc.type == \'dataset\'" doc="doc"></div>\r\n\t\t\t\t\t<select-group ng-if="doc.type == \'group\'" group="doc"></select-group>\r\n\t\t\t\t</div>\r\n  \t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/splash/splash.html",'<div class="modal-header">\r\n   <h3 class="modal-title splash">ELVIS - Foundation Spatial Data</h3>\r\n</div>\r\n<div class="modal-body" id="accept" ng-form exp-enter="accept()" icsm-splash-modal style="width: 100%; margin-left: auto; margin-right: auto;">\r\n\t<div>\r\n\t\t<p>\r\n\t\t\tHere you can download point cloud and elevation datasets sourced from jurisdictions.\r\n\t\t</p>\r\n\t\t<p>\r\n\t\t\t<a href="http://www.ga.gov.au/topographic-mapping/digital-elevation-data.html" target="_blank">Find out more on our Elevation page.</a>\r\n\t\t</p>\r\n\t\t<p>\r\n\t\t\tData can be downloaded at <strong>no charge</strong> and there is no limit to how many (please check the file size before you download your files).\r\n\t\t</p>\r\n\t\t<p>\r\n\t\t\t<a href="http://opentopo.sdsc.edu/gridsphere/gridsphere?cid=contributeframeportlet&gs_action=listTools" target="_blank">Click here for Free GIS Tools.</a>\r\n\t\t</p>\r\n      <h5>How to use</h5>\r\n      <p>\r\n         <ul>\r\n            <li>Pan and zoom the map to your area of interest,</li>\r\n            <li>Click on the "Select an area..." button to enable drawing,</li>\r\n            <li>Click on the map, holding the button down,</li>\r\n            <li>Drag to a diagonal corner (not too big, there is a limit of roughly 2 square degrees or 200 square km))</li>\r\n            <li>On release we will check for data within or very near your area of interest</li>\r\n            <li>If the list is large you can filter:\r\n               <ul>\r\n                  <li>Partial text match by typing in the filter field and/or</li>\r\n                  <li>You can restrict the display to either elevation (DEM) or point cloud file types</li>\r\n               </ul>\r\n            </li>\r\n            <li>Check against any file you would like to download. To reiterate, these files can be huge so take note of the file size before downloading</li>\r\n            <li>Review your selected datasets and submit.</li>\r\n            <li>An email will be sent to you with a link to all your data, zipped into a single file.</li>\r\n            <li>These files can be huge so take note of the file size before submitting or downloading</li>\r\n         </ul>\r\n      </p>\r\n      <h5>Hints</h5>\r\n      <p>\r\n         <ul>\r\n            <li>Hovering over many items will give you further information about the purpose of the item</li>\r\n            <li>Drawing a polyline allows you to measure distance along the polyline.</li>\r\n            <li>On completion on drawing a line the elevation along that line is plotted.</li>\r\n            <li>While the tool to draw your area of interest is enabled it is easiest to pan the map using the arrow keys.</li>\r\n            <li>There are many areas where there is no data though the coverage is improving all the time.</li\r\n         </ul>\r\n      </p>\r\n\t</div>\r\n   <div style="padding:30px; padding-top:0; padding-bottom:40px; width:100%">\r\n\t\t<div class="pull-right">\r\n\t\t  \t<button type="button" class="btn btn-primary" ng-model="seenSplash" ng-focus="" ng-click="accept()">Continue</button>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/themes/themes.html",'<div class="dropdown themesdropdown">\r\n  <button class="btn btn-default dropdown-toggle themescurrent" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">\r\n    Theme\r\n    <span class="caret"></span>\r\n  </button>\r\n  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">\r\n    <li ng-repeat="item in themes">\r\n       <a href="#" title="{{item.title}}" ng-href="{{item.url}}" class="themesItemCompact">\r\n         <span class="icsm-icon" ng-class="item.className"></span>\r\n         <strong style="vertical-align:top;font-size:110%">{{item.label}}</strong>\r\n       </a>\r\n    </li>\r\n  </ul>\r\n</div>'),t.put("icsm/toolbar/toolbar.html",'<div icsm-toolbar>\r\n\t<div class="row toolBarGroup">\r\n\t\t<div class="btn-group searchBar" ng-show="root.whichSearch != \'region\'">\r\n\t\t\t<div class="input-group" geo-search>\r\n\t\t\t\t<input type="text" ng-autocomplete ng-model="values.from.description" options=\'{country:"au"}\'\r\n\t\t\t\t\t\t\tsize="32" title="Select a locality to pan the map to." class="form-control" aria-label="...">\r\n\t\t\t\t<div class="input-group-btn">\r\n    \t\t\t\t<button ng-click="zoom(false)" exp-ga="[\'send\', \'event\', \'icsm\', \'click\', \'zoom to location\']"\r\n\t\t\t\t\t\tclass="btn btn-default"\r\n\t\t\t\t\t\ttitle="Pan and potentially zoom to location."><i class="fa fa-search"></i></button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="pull-right">\r\n\t\t\t<div class="btn-toolbar radCore" role="toolbar"  icsm-toolbar>\r\n\t\t\t\t<div class="btn-group">\r\n\t\t\t\t\t<!-- < icsm-state-toggle></icsm-state-toggle> -->\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="btn-toolbar" style="margin:right:10px;display:inline-block">\r\n\t\t\t\t<div class="btn-group">\r\n\t\t\t\t\t<span class="btn btn-default" common-baselayer-control max-zoom="16" title="Satellite to Topography bias on base map."></span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/view/view.html",'<div class="container-fluid downloadPane" >\r\n\t<div class="row">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<h4><icsm-wms data="data.item" ng-title="data.item.abstract"></icsm-wms>{{data.item.title}}</h4>\r\n  \t\t\t</div>\r\n\t</div>\r\n\t<icsm-clip data="data.item"></icsm-clip>\r\n\t<icsm-list></icsm-list>\r\n\t<div class="downloadCont" icsm-search-continue></div>\r\n</div>')}]);