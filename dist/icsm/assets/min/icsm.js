"use strict";!function(t){function e(t,e,n){var i=this;n.getMap().then(function(t){i.map=t}),e.getConfig().then(function(t){i.data=t;try{var e=document.createElement("canvas");t.modern=!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(n){t.modern=!1}})}t.module("IcsmApp",["common.altthemes","common.baselayer.control","common.cc4","common.header","common.legend","common.navigation","common.panes","common.storage","common.templates","common.toolbar","explorer.config","explorer.confirm","explorer.drag","explorer.enter","explorer.flasher","explorer.googleanalytics","explorer.httpdata","explorer.info","explorer.legend","explorer.message","explorer.modal","explorer.projects","explorer.tabs","explorer.version","exp.ui.templates","explorer.map.templates","ui.bootstrap","ui.bootstrap-slider","ngAutocomplete","ngRoute","ngSanitize","page.footer","geo.draw","geo.geosearch","geo.map","geo.maphelper","geo.measure","icsm.bounds","icsm.clip","icsm.glossary","icsm.help","elvis.header","elvis.results","icsm.mapevents","icsm.select","icsm.state","icsm.templates","icsm.view"]).config(["configServiceProvider","projectsServiceProvider","versionServiceProvider",function(t,e,n){t.location("icsm/resources/config/config.json"),t.dynamicLocation("icsm/resources/config/appConfig.json?t="),n.url("icsm/assets/package.json"),e.setProject("icsm")}]).config(["$routeProvider",function(t){t.when("/administrativeBoundaries",{templateUrl:"admin/app/app.html",controller:"adminCtrl",controllerAs:"admin"}).when("/positioning",{templateUrl:"positioning/app/app.html",controller:"positioningCtrl",controllerAs:"positioning"}).when("/placeNames",{templateUrl:"placenames/app/app.html",controller:"placeNamesCtrl",controllerAs:"placeNames"}).when("/landParcelAndProperty",{templateUrl:"landParcelAndProperty/app/app.html",controller:"landParcelAndPropertyCtrl",controllerAs:"landParcelAndProperty"}).when("/imagery",{templateUrl:"imagery/app/app.html",controller:"imageryCtrl",controllerAs:"imagery"}).when("/transport",{templateUrl:"transport/app/app.html",controller:"transportCtrl",controllerAs:"transport"}).when("/water",{templateUrl:"water/app/app.html",controller:"waterCtrl",controllerAs:"water"}).when("/elevationAndDepth",{templateUrl:"elevationAndDepth/app/app.html",controller:"elevationAndDepthCtrl",controllerAs:"elevationAndDepth"}).when("/landCover",{templateUrl:"landCover/app/app.html",controller:"landCoverCtrl",controllerAs:"landCover"}).when("/icsm",{templateUrl:"icsm/app/app.html",controller:"icsmCtrl",controllerAs:"icsm"}).otherwise({redirectTo:"/icsm"})}]).factory("userService",[function(){function t(){return!0}return{login:t,hasAcceptedTerms:t,setAcceptedTerms:t,getUsername:function(){return"anon"}}}]).controller("RootCtrl",e),e.$invoke=["$http","configService","mapService"]}(angular),function(t){t.module("icsm.bounds",[]).directive("icsmBounds",["flashService","messageService","boundsService",function(t,e,n){var i;return{restrict:"AE",link:function(){n.init().then(null,null,function(n){switch(t.remove(i),n.type){case"error":case"warn":case"info":e[n.type](n.text);break;default:t.remove(i),i=t.add(n.text,n.duration?n.duration:8e3,"wait"==n.type)}})}}}]).factory("boundsService",["$http","$q","$rootScope","$timeout","configService","flashService",function(e,n,i,r,a,o){function s(t,e,n){f&&f.notify({text:t,type:e,duration:n})}function l(t){var e=n.defer(),i=p(t);if(i&&i.code)switch(i.code){case"oversize":r(function(){s("","clear"),s("The selected area is too large to process. Please restrict to approximately 2 degrees square.","error"),e.resolve(i)});break;case"undersize":r(function(){s("","clear"),s("X Min and Y Min should be smaller than X Max and Y Max, respectively. Please update the drawn area.","error"),e.resolve(i)});break;default:return n.when(i)}return e.promise}function c(t){var e=(t.xMax-t.xMin)*(t.yMax-t.yMin);return e<1e-11||t.xMax<t.xMin}function d(t){var e=Math.abs((t.xMax-t.xMin)*(t.yMax-t.yMin));return e>4}function u(t){t.xMax=null===t.xMax?null:+t.xMax,t.xMin=null===t.xMin?null:+t.xMin,t.yMax=null===t.yMax?null:+t.yMax,t.yMin=null===t.yMin?null:+t.yMin}function p(t){return u(t),d(t)?{code:"oversize"}:c(t)?{code:"undersize"}:null===t.xMax?{code:"incomplete"}:m(t)?{code:"success"}:{code:"invalid"}}function m(e){return e&&t.isNumber(e.xMax)&&t.isNumber(e.xMin)&&t.isNumber(e.yMax)&&t.isNumber(e.yMin)&&!d(e)&&!c(e)}function h(t){a.getConfig("processing").then(function(n){var r=n.intersectsUrl;if(r){var a=r.replace("{maxx}",t.xMax).replace("{minx}",t.xMin).replace("{maxy}",t.yMax).replace("{miny}",t.yMin);s("Checking there is data in your selected area...","wait",18e4),e.get(a).then(function(t){if(t.data&&t.data.available_data){var e="There is no data held in your selected area. Please try another area.";s("","clear"),t.data.available_data&&t.data.available_data.forEach(function(t){t.downloadables&&(e="There is intersecting data. Select downloads from the list.")}),s(e),i.$broadcast("site.selection",t.data)}},function(t){s("The service that provides the list of datasets is currently unavailable. Please try again later.","error")})}})}var f;return{init:function(){return f=n.defer(),i.$on("icsm.clip.drawn",function(t,e){s("Area drawn. Checking for data..."),l(e).then(function(t){console.log(t),"success"===t.code?(i.$broadcast("icsm.bounds.draw",[e.xMin,e.yMin,e.xMax,e.yMax]),h(e)):i.$broadcast("icsm.clip.draw")})}),f.promise},cancelDraw:function(){drawService.cancelDrawRectangle()}}}])}(angular),function(t){t.module("elvis.header",[]).controller("headerController",["$scope","$q","$timeout",function(t,e,n){var i=function(t){return t};t.$on("headerUpdated",function(e,n){t.headerConfig=i(n)})}]).directive("elvisHeader",[function(){var e={heading:"ICSM",headingtitle:"ICSM",helpurl:"help.html",helptitle:"Get help about ICSM",helpalttext:"Get help about ICSM",skiptocontenttitle:"Skip to content",skiptocontent:"Skip to content",quicklinksurl:"/search/api/quickLinks/json?lang=en-US"};return{transclude:!0,restrict:"EA",templateUrl:"icsm/header/header.html",scope:{breadcrumbs:"=",heading:"=",headingtitle:"=",helpurl:"=",helptitle:"=",helpalttext:"=",skiptocontenttitle:"=",skiptocontent:"=",quicklinksurl:"="},link:function(n,i,r){t.copy(e);t.forEach(e,function(t,e){e in n||(n[e]=t)})}}}]).factory("headerService",["$http",function(){}])}(angular),function(t){t.module("icsm.clip",["geo.draw"]).directive("icsmInfoBbox",function(){return{restrict:"AE",templateUrl:"icsm/clip/infobbox.html"}}).directive("icsmClip",["$rootScope","$timeout","clipService","messageService","mapService",function(t,e,n,i,r){return{templateUrl:"icsm/clip/clip.html",scope:{bounds:"=",trigger:"=",drawn:"&"},link:function(a,o){function s(e){var n=a.clip;n.xMax=+e.clip.xMax,n.xMin=+e.clip.xMin,n.yMax=+e.clip.yMax,n.yMin=+e.clip.yMin,t.$broadcast("icsm.clip.drawn",n)}var l;a.clip={xMax:null,xMin:null,yMax:null,yMin:null},a.typing=!1,"undefined"==typeof a.showBounds&&(a.showBounds=!1),r.getMap().then(function(t){a.$watch("bounds",function(t){t&&a.trigger?e(function(){a.initiateDraw()}):t||n.cancelDraw()}),e(function(){console.info("start draw"),a.initiateDraw()},100)}),a.check=function(){e.cancel(l),l=e(function(){t.$broadcast("icsm.clip.drawn",a.clip)},4e3)},t.$on("icsm.clip.draw",function(){a.initiateDraw()}),a.initiateDraw=function(){i.info("Click on the map and drag to define your area of interest."),n.initiateDraw().then(s)}}}}]).factory("clipService",["$q","$rootScope","drawService",function(t,e,n){function i(t){return{clip:{xMax:t.bounds.getEast().toFixed(5),xMin:t.bounds.getWest().toFixed(5),yMax:t.bounds.getNorth().toFixed(5),yMin:t.bounds.getSouth().toFixed(5)}}}return{initiateDraw:function(){return n.drawRectangle().then(i)},cancelDraw:function(){n.cancelDrawRectangle()}}}])}(angular),function(t){function e(t,e){var n=this;t.info("HelpCtrl"),e.getFaqs().then(function(t){n.faqs=t})}function n(t){var e="icsm/resources/config/faqs.json";return{getFaqs:function(){return t.get(e,{cache:!0}).then(function(t){return t.data})}}}t.module("icsm.help",[]).directive("icsmHelp",[function(){return{templateUrl:"icsm/help/help.html"}}]).directive("icsmFaqs",[function(){return{restrict:"AE",templateUrl:"icsm/help/faqs.html",scope:{faqs:"="},link:function(t){t.focus=function(t){$("#faqs_"+t).focus()}}}}]).controller("HelpCtrl",e).factory("helpService",n),e.$inject=["$log","helpService"],n.$inject=["$http"]}(angular),function(t){function e(t,e){var n=this;t.info("GlossaryCtrl"),e.getTerms().then(function(t){n.terms=t})}function n(t){var e="icsm/resources/config/glossary.json";return{getTerms:function(){return t.get(e,{cache:!0}).then(function(t){return t.data})}}}t.module("icsm.glossary",[]).directive("icsmGlossary",[function(){return{templateUrl:"icsm/glossary/glossary.html"}}]).controller("GlossaryCtrl",e).factory("glossaryService",n),e.$inject=["$log","glossaryService"],n.$inject=["$http"]}(angular),function(t){t.module("icsm.list",[]).directive("icsmList",["$rootScope","listService",function(e,n){return{templateUrl:"icsm/list/list.html",link:function(i){function r(e){function n(t,e){var n=[];return(t||[]).forEach(function(t){t[e.countField]&&!function(){var i={};e.fields.forEach(function(e){i[e]=t[e]}),n.push(i)}()}),n}var r={};e.group={},t.forEach(i.filetypes,function(t,i){var a=n(e.downloadables,t);a.length&&(e.group[i]=a),r[t.countField]=t}),console.log(e)}function a(e,n){var i=[];t.forEach(n,function(t){t.count=0,i.push(t)}),e&&e.forEach(function(t){t.downloadables.forEach(function(t){i.forEach(function(e){e.count+=t[e.countField]?1:0})})})}function o(e,n){var i=e,a=!1,o={};return e&&n&&t.forEach(n,function(t){t.selected&&(a=!0,t.fields.forEach(function(t){o[t]=!0}))}),a&&(i=e.map(function(e){var n,i=[];return e.downloadables.forEach(function(e){var n=!1,r={};t.forEach(e,function(t,e){o[e]&&(n=!0,r[e]=t)}),n&&(r.bbox=e.bbox,r.index_poly_name=e.index_poly_name,i.push(r))}),n={source:e.source,downloadables:i},r(n),n}).filter(function(t){return t.downloadables.length>0})),i}function s(e,n){var i=[];return n?(e.forEach(function(e){if(e&&e.downloadables&&e.downloadables.length){var a=[];if(e.downloadables.forEach(function(e){var i=null;t.forEach(e,function(t,r){r.indexOf("name")!=-1&&(""+t).toUpperCase().search(n.toUpperCase())>-1&&(i=e)}),i&&a.push(i)}),a.length){var o={downloadables:a,source:e.source};r(o),i.push(o)}}}),i):e}function l(e){return t.isArray(e)||!e?e:e.split(/,\s*/g).map(function(t){return+t})}n.getMappings().then(function(t){i.mappings=t}),n.getFiletypes().then(function(t){i.filetypes=t}),i.filter="",i.matched=function(){var t=0;return i.list&&i.list.forEach(function(e){t+=e.downloadables.length}),t},i.fullCount=function(t){var e=0;return i.list.forEach(function(n){n.source==t&&(e=n.downloadables.length)}),e},i.update=function(){var t=s(i.list,i.filter);i.filteredList=o(t,i.filetypes),i.typeCounts=a(t,i.filetypes)},e.$on("site.selection",function(t,e){i.list=[],e.available_data&&e.available_data.forEach(function(t){t&&t.downloadables&&t.downloadables.length&&(r(t),i.list.push(t))}),i.expansions=n.createExpansions(),i.update()}),i.show=function(t){var n=l(t.bbox);e.$broadcast("icsm.bbox.draw",n),console.log("show",n)},i.hide=function(t){e.$broadcast("icsm.bbox.draw",null),console.log("hide")}}}}]).factory("listService",["$http",function(t){var e={},n={};return e.createExpansions=function(){return n={}},e.getMappings=function(){return t.get("icsm/resources/config/list.json").then(function(t){return t.data})},e.getFiletypes=function(){return t.get("icsm/resources/config/filetypes.json").then(function(t){return t.data})},e}]).filter("downloadables",function(){return function(t){console.log(t);var e=[];return t&&t.forEach(function(t){t&&t.downloadables&&t.downloadables.length&&e.push(t)}),e}}).filter("fileSize",function(){var t=1e6,e=1e3*t,n=1e3*e;return function(i){return i?(""+i).indexOf(" ")>-1?i:(i=parseFloat(i),i<1e3?i+" bytes":i<t?(i/1e3).toFixed(1)+" kB":i<e?(i/t).toFixed(1)+" MB":i<n?(i/e).toFixed(1)+" GB":(i/n).toFixed(1)+" TB"):"-"}})}(angular),function(t){angular.module("icsm.mapevents",["geo.map"]).directive("icsmMapevents",["icsmMapeventsService",function(t){return{restrict:"AE",link:function(e){t.tickle()}}}]).factory("icsmMapeventsService",["$rootScope","$timeout","configService","mapService",function(t,e,n,i){function r(t){i.getMap().then(function(e){if(s&&e.removeLayer(s),t){var n;n="undefined"!=typeof t.properties.SAMPLE_LONGITUDE?{type:"Point",coordinates:[t.properties.SAMPLE_LONGITUDE,t.properties.SAMPLE_LATITUDE]}:t.geometry,s=L.geoJson({type:"Feature",geometry:n,id:t.id}).addTo(e),t.properties.html&&s.bindPopup(t.properties.html).openPopup()}})}function a(t,n){console.log("pre getting map to make poly"),i.getMap().then(function(i){console.log("getting map to make poly"),l&&i.removeLayer(l),t&&(l=L.geoJson(t,{style:function(t){return{opacity:1,clickable:!1,fillOpacity:0,color:"red"}}}).addTo(i),n&&e(function(){var t=l.getBounds();i.fitBounds(t,{animate:!0,padding:L.point(100,100)})},50))})}function o(t,n){console.log("pre getting map to make bounds"),i.getMap().then(function(i){console.log("getting map to make poly"),c&&i.removeLayer(c),t&&(c=L.geoJson(t,{style:function(t){return{opacity:1,clickable:!1,fillOpacity:0,color:"black"}}}).addTo(i),n&&e(function(){var t=c.getBounds();i.fitBounds(t,{animate:!0,padding:L.point(100,100)})},50))})}var s,l,c,d=n.getConfig("mapConfig");return t.$on("icsm.bounds.draw",function(t,e){if(!e)return void o(null);var n=e[2],i=e[0],r=e[3],a=e[1];o({type:"Feature",geometry:{type:"Polygon",coordinates:[[[i,a],[n,a],[n,r],[i,r],[i,a]]]},properties:{}},!1)}),t.$on("icsm.bbox.draw",function(t,e){if(!e)return void a(null);var n=e[2],i=e[0],r=e[3],o=e[1];a({type:"Feature",geometry:{type:"Polygon",coordinates:[[[i,o],[n,o],[n,r],[i,r],[i,o]]]},properties:{}},!1)}),t.$on("icsm.poly.draw",function(t,e){a(e,!0)}),d.listenForMarkerEvent&&t.$on(d.listenForMarkerEvent,function(t,e){r(e)}),{tickle:function(){i.getMap().then(function(e){e.on("click",function(n){var i=e.getZoom(),r=n.latlng;t.$broadcast("zoom.to",{zoom:i,latlng:r})})})}}}])}(),function(t){function e(t){t.data().then(function(t){this.data=t}.bind(this))}function n(){return{add:function(t){},remove:function(t){}}}t.module("icsm.panes",[]).directive("icsmPanes",["$rootScope","$timeout","mapService",function(t,e,n){return{templateUrl:"icsm/panes/panes.html",transclude:!0,scope:{defaultItem:"@",data:"="},controller:["$scope",function(i){var r=!1;i.view=i.defaultItem,i.setView=function(e){var a=i.view;i.view==e?(e&&(r=!0),i.view=""):(e||(r=!0),i.view=e),t.$broadcast("view.changed",i.view,a),r&&n.getMap().then(function(t){t._onResize()})},e(function(){t.$broadcast("view.changed",i.view,null)},50)}]}}]).directive("icsmTabs",[function(){return{templateUrl:"icsm/panes/tabs.html",require:"^icsmPanes"}}]).controller("PaneCtrl",e).factory("paneService",n),e.$inject=["paneService"],n.$inject=[]}(angular),function(t){t.module("icsm.plot",[]).directive("icsmPlot",["$log",function(t){return{restrict:"AE",scope:{line:"="},link:function(e,n,i,r){e.$watch("line",function(e,n){t.info(e)})}}}])}(angular),function(t){t.module("elvis.results",[]).directive("icsmList",["$rootScope","listService",function(e,n){return{templateUrl:"icsm/list/list.html",link:function(i){function r(e,n){var i=[];t.forEach(n,function(t){t.count=0,i.push(t)}),e&&e.forEach(function(t){t.downloadables.forEach(function(t){i.forEach(function(e){e.count+=t[e.countField]?1:0})})})}function a(e,n){var i=[];return n?(e.forEach(function(e){if(e&&e.downloadables&&e.downloadables.length){var r=[];if(e.downloadables.forEach(function(e){var i=null;t.forEach(e,function(t,r){r.indexOf("name")!=-1&&(""+t).toUpperCase().search(n.toUpperCase())>-1&&(i=e)}),i&&r.push(i)}),r.length){var a={downloadables:r,source:e.source};decorateGroups(a),i.push(a)}}}),i):e}function o(e){return t.isArray(e)||!e?e:e.split(/,\s*/g).map(function(t){return+t})}n.getMappings().then(function(t){i.mappings=t}),n.getFiletypes().then(function(t){i.filetypes=t}),i.filter="",i.matched=function(){var e=0;return i.list&&i.list.forEach(function(n){n.downloadables&&t.forEach(n.downloadables,function(t){e+=t.length})}),e},i.fullCount=function(e){var n=0;return i.list.forEach(function(n){var i=0;n.source==e&&t.forEach(item.downloadables,function(t){i+=t.length})}),n},i.update=function(){var t=a(i.list,i.filter);i.filteredList=filterTypes(t,i.filetypes),i.typeCounts=r(t,i.filetypes)},e.$on("site.selection",function(t,e){i.list=[],e.available_data&&(i.list=e.available_data),i.expansions=n.createExpansions(),i.update()}),i.show=function(t){var n=o(t.bbox);e.$broadcast("icsm.bbox.draw",n),console.log("show",n)},i.hide=function(t){e.$broadcast("icsm.bbox.draw",null),console.log("hide")}}}}]).factory("listService",["$http",function(t){var e={},n={};return e.createExpansions=function(){return n={}},e.getMappings=function(){return t.get("icsm/resources/config/list.json").then(function(t){return t.data})},e.getFiletypes=function(){return t.get("icsm/resources/config/filetypes.json").then(function(t){return t.data})},e}]).filter("downloadables",function(){return function(t){console.log(t);var e=[];return t&&t.forEach(function(t){t&&t.downloadables&&t.downloadables.length&&e.push(t)}),e}}).filter("fileSize",function(){var t=1e6,e=1e3*t,n=1e3*e;return function(i){return i?(""+i).indexOf(" ")>-1?i:(i=parseFloat(i),i<1e3?i+" bytes":i<t?(i/1e3).toFixed(1)+" kB":i<e?(i/t).toFixed(1)+" MB":i<n?(i/e).toFixed(1)+" GB":(i/n).toFixed(1)+" TB"):"-"}})}(angular),function(t){function e(t,e,i,r,a,o){function s(){r(function(){f._executeQuery()},100)}var l,c="Search Layers",d="icsm/resources/config/select.json",u={text:"",daterange:{enabled:!1,upper:null,lower:null},bbox:{fromMap:!0,intersects:!0,yMax:null,yMin:null,xMax:null,xMin:null},defaultKeywords:[],keywords:[]},p={},m="#ff7800",h="darkblue",f={getSelectCriteria:function(){return u},getLayerGroup:function(){return l||(l=a.getGroup(c)),l},setKeywords:function(t){},setFilter:function(t){},refresh:function(){},getDaterange:function(){return u.daterange},more:function(){},_executeQuery:function(){t.get(d,{cache:!0}).then(function(t){f.getLayerGroup();var e=t.data;e.response.docs.forEach(function(t){f._decorateDataset(t),"group"==t.type&&t.docs.forEach(function(t){f._decorateDataset(t)})}),i.$broadcast("select.facet.counts",e),i.$broadcast("select.results.received",e)})},createLayer:function(t,e){var n,i,r,a=t.bbox,o=t.primaryId;if(r=p[o],!r){if(!a)return null;if(n=a.split(" "),4!=n.length)return null;e||(e=m),i=[[+n[1],+n[0]],[+n[3],+n[2]]],r=L.rectangle(i,{fill:!1,color:"#000000",width:3,clickable:!1}),p[o]=r}return this._decorateDataset(t),l.addLayer(r),r},_decorateDataset:function(t){function e(t){var e;return t?(e=t.split(/\s/g),{xMin:+e[0],xMax:+e[2],yMax:+e[3],yMin:+e[1]}):null}var i=p[t.primaryId];i?(t.layer=i,t.showLayer=!0):(t.layer=null,t.showLayer=!1,t.services=n(t.dcUris),t.bounds=e(t.bbox))},showWithin:function(t){function e(t,e,n,i){var r=u.bbox;return t>r.xMin&&n<r.xMax&&e>r.yMin&&i<r.yMax}t.forEach(function(t){var n,i=t.bbox;i?(n=i.split(" "),4==n.length&&e(+n[0],+n[1],+n[2],+n[3])?f.createLayer(t):f.removeLayer(t)):f.removeLayer(t)})},toggle:function(t){t.showLayer?this.removeLayer(t):this.createLayer(t)},toggleAll:function(t){var e=this,n=t.some(function(t){return!t.showLayer});return t.forEach(function(t){n?t.showLayer||e.createLayer(t):t.showLayer&&e.removeLayer(t)}),!n},hideAll:function(t){t.forEach(function(t){t.showLayer&&f.removeLayer(t)})},hilight:function(t){t.setStyle({color:h})},lolight:function(t){t.setStyle({color:m})},removeLayer:function(t){var e=t.primaryId,n=p[e];n&&(l.removeLayer(n),delete p[e]),this._decorateDataset(t)}};return s(),f}function n(t){function e(t){this.uris=t,this.container={wcs:null,wms:null},t?this.services=t.map(function(t){var e=new n(t);return this.container.wcs=e.isWcs()?e:this.container.wcs,this.container.wms=e.isWms()?e:this.container.wms,e}.bind(this)):this.services=[],this.hasWcs=function(){return null!==this.container.wcs},this.hasWms=function(){return null!==this.container.wms},this.getWcs=function(){return this.container.wcs},this.getWms=function(){return this.container.wms},this.remove=function(){this.services.forEach(function(t){t.remove()})}}function n(t){var e=$(t);this.protocol=e.attr("protocol"),this.url=e.text(),this.layerNames=e.attr("layerNames"),this.name=e.attr("name"),this.description=e.attr("description"),this.handlers=[],this.isWcs=function(){return this.protocol==i.WCS},this.isWfs=function(){return this.protocol==i.WFS},this.isWms=function(){return this.protocol==i.WMS},this.isSupported=function(){return"undefined"==typeof i[this.protocol]},this.addHandler=function(t){this.handlers.push(t)},this.removeHandler=function(t){this.handlers.push(t)},this.remove=function(){this.handlers.forEach(function(t){this.callback.remove&&t.remove(this)}.bind(this)),this.handlers=[]}}var i={WCS:"OGC:WCS",WFS:"OGC:WFS",WMS:"OGC:WMS"};return new e(t)}t.module("icsm.select.service",[]).factory("selectService",e),e.$inject=["$http","$q","$rootScope","$timeout","mapService","configService"]}(angular),function(t){function e(t){this.criteria=t.getSelectCriteria(),this.refresh=function(){t.refresh()}}function n(t,e,n,i){var r,a=this;t.$on("select.results.received",function(t,e){n.remove(r),a.data=e}),e.getConfig("facets").then(function(t){this.hasKeywords=t&&t.keywordMapped&&t.keywordMapped.length>0}.bind(this)),this.select=function(){n.remove(r),r=n.add("Selecting",3e3,!0),i.setFilter(this.filter)},this.toggle=function(t){i.toggle(t)},this.toggleAll=function(){i.toggleAll(this.data.response.docs)},this.showWithin=function(){i.showWithin(this.data.response.docs)},this.allShowing=function(){return!(!this.data||!this.data.response)&&!this.data.response.docs.some(function(t){return!t.showLayer})},this.anyShowing=function(){return!(!this.data||!this.data.response)&&this.data.response.docs.some(function(t){return t.showLayer})},this.hideAll=function(){i.hideAll(this.data.response.docs)},this.hilight=function(t){t.layer&&i.hilight(t.layer)},this.lolight=function(t){t.layer&&i.lolight(t.layer)}}t.module("icsm.select",["icsm.select.service"]).controller("SelectCtrl",n).controller("SelectCriteriaCtrl",e).directive("icsmSelect",[function(){return{templateUrl:"icsm/select/select.html",link:function(t,e,n){console.log("Hello select!")}}}]).directive("selectDoc",[function(){return{templateUrl:"icsm/select/doc.html",link:function(t,e,n){console.log("What's up doc!")}}}]).directive("selectGroup",[function(){return{templateUrl:"icsm/select/group.html",scope:{group:"="},link:function(t,e,n){console.log("What's up doc!")}}}]).filter("pubDate",function(){return function(t){var e;return t?(e=new Date(t),e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()):"-"}}).filter("authors",function(){return function(t){return t?t.join(", "):"-"}}).filter("truncate",function(){return function(t,e){return t&&t.length>e-3?t.substr(0,e-3)+"...":t}}),e.$inject=["selectService"],n.$inject=["$rootScope","configService","flashService","selectService"]}(angular),function(t){t.module("icsm.splash",[]).directive("icsmSplash",["$rootScope","$uibModal","$log","splashService",function(t,e,n,i){return{controller:["$scope","splashService",function(t,e){t.acceptedTerms=!0,e.getReleaseNotes().then(function(n){t.releaseMessages=n,t.acceptedTerms=e.hasViewedSplash()})}],link:function(r,a){var o;r.$watch("acceptedTerms",function(t){t===!1&&(o=e.open({templateUrl:"icsm/splash/splash.html",size:"lg",backdrop:"static",keyboard:!1,controller:["$scope","$uibModalInstance","acceptedTerms","messages",function(t,e,n,i){t.acceptedTerms=n,t.messages=i,t.accept=function(){e.close(!0)}}],resolve:{acceptedTerms:function(){return r.acceptedTerms},messages:function(){return r.releaseMessages}}}),o.result.then(function(t){n.info("Accepted terms"),r.acceptedTerms=t,i.setHasViewedSplash(t)},function(){n.info("Modal dismissed at: "+new Date)}))}),t.$on("logoutRequest",function(){userService.setAcceptedTerms(!1)})}}}]).factory("splashService",["$http",function(t){function e(t){t?sessionStorage.setItem(i,!0):sessionStorage.removeItem(i)}function n(){return!!sessionStorage.getItem(i)}var i="icsm.accepted.terms",r="icsm/resources/service/releaseNotes";return{getReleaseNotes:function(){return t({method:"GET",url:r+"?t="+Date.now()}).then(function(t){return t.data})},hasViewedSplash:n,setHasViewedSplash:e}}]).filter("priorityColor",[function(){var t={IMPORTANT:"red",HIGH:"blue",MEDIUM:"orange",LOW:"gray"};return function(e){return e in t?t[e]:"black"}}]).filter("wordLowerCamel",function(){return function(t){return t.charAt(0)+t.substr(1).toLowerCase()}}).filter("sortNotes",[function(){return function(t){if(t){var e=t.slice(0).sort(function(t,e){return t.priority==e.priority?t.lastUpdate==e.lastUpdate?0:e.lastUpdate-t.lastUpdate:"IMPORTANT"==t.priority?-11:1});return e}}}])}(angular),function(t){t.module("icsm.state",[]).directive("icsmStateToggle",["downloadService",function(t){return{restrict:"AE",template:'<button ng-click="toggle(false)" ng-disabled="state.show" class="btn btn-default" title="Start downlaod selection."><i class="fa fa-lg fa-object-group"></i></button>',link:function(e){t.data().then(function(t){e.state=t}),e.toggle=function(){e.state.show=!e.state.show}}}}])}(angular),function(t){t.module("icsm.themes",[]).directive("icsmThemes",["themesService",function(t){return{restrict:"AE",templateUrl:"icsm/themes/themes.html",link:function(e){t.getThemes().then(function(t){e.themes=t}),t.getCurrentTheme().then(function(t){e.theme=t}),e.changeTheme=function(n){e.theme=n,t.setTheme(n.key)}}}}]).controller("themesCtrl",["themesService",function(t){this.service=t}]).filter("themesFilter",function(){return function(t,e){var n=[];return e?(t&&t.forEach(function(t){t.themes&&t.themes.some(function(t){return t==e.key})&&n.push(t)}),n):t}}).factory("themesService",["$q","configService","storageService",function(e,n,i){var r="icsm.current.theme",a="All",o=[],s=this;return this.themes=[],this.theme=null,i.getItem(r).then(function(e){e||(e=a),n.getConfig("themes").then(function(n){s.themes=n,s.theme=n[e],t.forEach(n,function(t,e){t.key=e}),o.forEach(function(t){t.resolve(s.theme)})})}),this.getCurrentTheme=function(){if(this.theme)return e.when(s.theme);var t=e.defer();return o.push(t),t.promise},this.getThemes=function(){return n.getConfig("themes")},this.setTheme=function(t){this.theme=this.themes[t],i.setItem(r,t)},this}])}(angular),function(t){t.module("icsm.toolbar",[]).directive("icsmToolbar",[function(){return{controller:"toolbarLinksCtrl"}}]).directive("icsmToolbarRow",[function(){return{scope:{map:"="},restrict:"AE",templateUrl:"icsm/toolbar/toolbar.html"}}]).directive("icsmToolbarInfo",[function(){return{templateUrl:"radwaste/toolbar/toolbarInfo.html"}}]).controller("toolbarLinksCtrl",["$scope","configService",function(t,e){var n=this;e.getConfig().then(function(t){n.links=t.toolbarLinks}),t.item="",t.toggleItem=function(e){t.item=t.item==e?"":e}}])}(angular),function(t,e){function n(t){t.data().then(function(t){this.data=t}.bind(this)),this.remove=function(){t.clear()},this.changeEmail=function(e){t.setEmail(e)}}function i(t,e,n,i,r){var a="download_email",o="Download Layers",s={zoom:null,center:null,layer:null},l=null,c={getLayerGroup:function(){return i.getGroup(o)},setState:function(t){function e(){[[t.bounds.yMin,t.bounds.xMin],[t.bounds.yMax,t.bounds.xMax]];s.layer&&i.getGroup(o).removeLayer(s.layer)}function n(t){s.layer&&(i.clearGroup(o),s.layer=null)}t?e():n()},decorate:function(){var t=l.item;l.item.download=!0,t.processsing||(t.processing={clip:{xMax:null,xMin:null,yMax:null,yMin:null}})},setEmail:function(t){r.setItem(a,t)},getEmail:function(){return r.getItem(a).then(function(t){return l.email=t,t})},data:function(){return l?e.when(l):t.get("icsm/resources/config/icsm.json").then(function(t){return l=t.data,c.decorate(),l})}};return c}t.module("icsm.view",[]).directive("icsmView",["downloadService",function(t){return{templateUrl:"icsm/view/view.html",controller:"DownloadCtrl",link:function(e,n){t.data().then(function(t){e.data=t}),e.$watch("data.item",function(e,n){(e||n)&&t.setState(e)})}}}]).controller("DownloadCtrl",n).factory("downloadService",i),n.$inject=["downloadService"],i.$inject=["$http","$q","$rootScope","mapService","storageService"]}(angular,$),angular.module("icsm.templates",[]).run(["$templateCache",function(t){t.put("icsm/app/app.html",'<div>\r\n\t<!-- BEGIN: Sticky Header -->\r\n\t<div explorer-header style="z-index:1"\r\n\t\t\tclass="navbar navbar-default navbar-fixed-top"\r\n\t\t\theading="\'ELVIS - Foundation Spatial Data\'"\r\n\t\t\theadingtitle="\'ICSM\'"\r\n\t\t\tbreadcrumbs="[{name:\'ICSM\', title: \'Reload ELVIS - Foundation Spatial Data\', url: \'.\'}]"\r\n\t\t\thelptitle="\'Get help about ELVIS - Foundation Spatial Data\'"\r\n\t\t\thelpalttext="\'Get help about ELVIS - Foundation Spatial Data\'">\r\n\t</div>\r\n\t<!-- END: Sticky Header -->\r\n\r\n\r\n\t<!-- Messages go here. They are fixed to the tab bar. -->\r\n\t<div explorer-messages class="marsMessages noPrint"></div>\r\n\r\n\t<icsm-panes data="root.data" default-item="download"></icsm-panes>\r\n</div>'),t.put("icsm/header/header.html",'<div class="container-full common-header" style="padding-right:10px; padding-left:10px">\r\n    <div class="navbar-header">\r\n\r\n        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".ga-header-collapse">\r\n            <span class="sr-only">Toggle navigation</span>\r\n            <span class="icon-bar"></span>\r\n            <span class="icon-bar"></span>\r\n            <span class="icon-bar"></span>\r\n        </button>\r\n\r\n        <a href="http://www.ga.gov.au" class="hidden-xs header-logo">\r\n            <img src="icsm/resources/img/Geoscience Australia.jpg" alt="Geoscience Australia" class="elvis-logo"></img>\r\n            <img src="icsm/resources/img/NSW.jpg" alt="NSW Land $amp;Property Information" class="elvis-logo"></img>\r\n            <img src="icsm/resources/img/logo-ACT.jpg" alt="ACT Government" class="elvis-logo"></img>\r\n         </a>\r\n        <a href="http://www.ga.gov.au" class="visible-xs"><img src="icsm/resources/img/icsm-logo-sml.gif" alt="ICSM - ANZLIC Committee on Surveying &amp; Mapping" class="logo-stacked"></img></a>\r\n        <a href="/" class="appTitle visible-xs"><h1 style="font-size:120%">{{heading}}</h1></a>\r\n    </div>\r\n    <div class="navbar-collapse collapse ga-header-collapse">\r\n        <ul class="nav navbar-nav">\r\n            <li class="hidden-xs"><a href="/"><h1 class="applicationTitle">{{heading}}</h1></a></li>\r\n        </ul>\r\n        <ul class="nav navbar-nav navbar-right nav-icons">\r\n        \t<li common-navigation ng-show="username" role="menuitem" style="padding-right:10px"></li>\r\n\t\t\t<li mars-version-display role="menuitem"></li>\r\n\t\t\t<li style="width:10px"></li>\r\n        </ul>\r\n        <div class="breadcrumbsContainer hidden-xs">\r\n            <ul class="breadcrumbs">\r\n                <li class="first"><a href="/">Home</a></li>\r\n                <li ng-class="{last:$last}" ng-repeat="crumb in breadcrumbs"><a href="{{crumb.url}}" title="{{crumb.title}}" >{{crumb.name}}</a></li>\r\n            </ul>\r\n        </div>\r\n    </div><!--/.nav-collapse -->\r\n</div>\r\n\r\n<!-- Strap -->\r\n<div class="row">\r\n    <div class="col-md-12">\r\n        <div class="strap-blue">\r\n        </div>\r\n        <div class="strap-white">\r\n        </div>\r\n        <div class="strap-red">\r\n        </div>\r\n    </div>\r\n</div>'),t.put("icsm/clip/clip.html",'<div class="well well-sm">\r\n\t<div class="container-fluid">\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-10">\r\n\t\t\t\t<strong style="font-size:120%">Select area:</strong>\r\n\t\t\t\t<button ng-click="initiateDraw()" ng-disable="client.drawing" tooltip-placement="right" uib-tooltip="Enable drawing of a bounding box. On enabling, click on the map and drag diagonally"\r\n\t\t\t\t\tclass="btn btn-primary btn-default">Draw...</button>\r\n\t\t\t\t<button ng-click="typing = !typing"  tooltip-placement="right" uib-tooltip="Type coordinates of a bounding box. Restricted to maximum of 2x2 degrees."\r\n\t\t\t\t\tclass="btn btn-primary btn-default">Manual entry...</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-2">\r\n\t\t\t\t<button style="float:right" ng-click="showInfo = !showInfo" tooltip-placement="left" uib-tooltip="Information." class="btn btn-primary btn-default"><i class="fa fa-info"></i></button>\r\n\t\t\t\t<exp-info title="Selecting an area" show-close="true" style="width:450px;position:fixed;top:230px;right:40px" is-open="showInfo">\r\n\t\t\t\t\t<icsm-info-bbox>\r\n\t\t\t</div>\r\n\t\t\t</exp-info>\r\n\t\t</div>\r\n\r\n\t\t<div class="row" ng-hide="hding">\r\n\t\t\t<div class="col-md-12">\r\n\t\t\t\tSelected {{clip.xMin|number : 4}}&deg; west, {{clip.yMax|number : 4}}&deg; north, {{clip.yMax|number : 4}}&deg; east, {{clip.xMin|number : 4}}&deg; south\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="container-fluid" style="padding-top:7px" ng-show="typing">\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-3"> </div>\r\n\t\t\t<div class="col-md-8">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">Y Max:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.yMax" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.yMax|number : 4}} max)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">X Min:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.xMin" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.xMin|number : 4}} min)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">X Max:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.xMax" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.xMax|number : 4}} max)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-offset-3 col-md-8">\r\n\t\t\t\t<div style="font-weight:bold;width:3.5em;display:inline-block">Y Min:</div>\r\n\t\t\t\t<span>\r\n               <input type="text" style="width:6em" ng-model="clip.yMin" ng-change="check()"></input>\r\n               <span ng-show="showBounds && bounds">({{bounds.yMin|number : 4}} min)</span>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),
t.put("icsm/clip/infobbox.html",'<div class="">\r\n\t<strong style="font-size:120%">Select an area of interest.</strong> There are two ways to select your area of interest:\r\n\t<ol>\r\n\t\t<li>By hitting the "Draw" button an area on the map can be selected with the mouse by clicking a\r\n         corner and while holding the left mouse button\r\n\t\t\tdown drag diagonally across the map to the opposite corner or</li>\r\n\t\t<li>By hitting the "Manual entry" button which shows inputs to allow the entry of coordinates. .</li>\r\n\t</ol>\r\n\tOnce drawn the points can be modified by the overwriting the values manually or drawing another area by\r\n   clicking the "Draw" button again. <br/>\r\n\t<strong>Notes:</strong>\r\n   <ul>\r\n      <li>The data does not cover all of Australia.</li>\r\n      <li>Restrict a search area to below four square degrees. eg 2x2 or 1x4</li>\r\n   </ul>\r\n\t<p style="padding-top:5px"><strong>Hint:</strong> If the map has focus, you can use the arrow keys to pan the map.\r\n\t\tYou can zoom in and out using the mouse wheel or the "+" and "-" map control on the top left of the map. If you\r\n\t\tdon\'t like the position of your drawn area, hit the "Draw" button and draw a new bounding box.\r\n\t</p>\r\n</div>'),t.put("icsm/help/faqs.html",'<div class="container" style="width:100%;border: 1px solid lightgray">\r\n\t<p style="text-align: left; margin: 10px; font-size: 14px;">\r\n\t\t<strong>FAQS</strong>\r\n\t</p>\t\r\n\r\n\t<h5 ng-repeat="faq in faqs"><button type="button" class="undecorated" ng-click="focus(faq.key)">{{faq.question}}</button></h5>\r\n\t<hr/>\r\n\t<div class="row" ng-repeat="faq in faqs">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<h5 tabindex="0" id="faqs_{{faq.key}}">{{faq.question}}</h5>\r\n\t\t\t<span ng-bind-html="faq.answer"></span>\r\n\t\t\t<hr/>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/help/help.html",'<div ng-controller="HelpCtrl as help">\r\n\t<div style="position:relative;padding:5px;padding-left:10px;" >\r\n\t\t<div class="panel panel-default" style="padding:5px;" >\r\n\t\t\t<div class="panel-heading">\r\n\t\t\t\t<h3 class="panel-title">Help</h3>\r\n\t\t\t</div>\r\n\t\t\t<div class="panel-body">\r\n\t\t\t\tThe steps to get data!\r\n\t\t\t\t<ol>\r\n\t\t\t\t\t<li>Select dataset of interest <i class="fa fa-download"></i> from Select tab</li>\r\n\t\t\t\t\t<li>Define area</li>\r\n\t\t\t\t\t<li>Select output format</li>\r\n\t\t\t\t\t<li>Select coordinate system</li>\r\n\t\t\t\t\t<li>Enter email address</li>\r\n\t\t\t\t\t<li>Submit entries</li>\r\n\t\t\t\t</ol>\r\n\t\t\t\tAn email will be sent to you on completion of the data extract with a link to your data.\r\n\t\t\t\t<icsm-faqs faqs="help.faqs" ></icsm-faqs>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/glossary/glossary.html",'<div ng-controller="GlossaryCtrl as glossary">\r\n\t<div style="position:relative;padding:5px;padding-left:10px;" >\r\n\t\t<div class="panel panel-default" style="padding:5px;" >\r\n\t\t\t<div class="panel-heading">\r\n\t\t\t\t<h3 class="panel-title">Glossary</h3>\r\n\t\t\t</div>\r\n\t\t\t<div class="panel-body">\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t<table class="table table-striped">\r\n\t\t<thead>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>Term</th>\r\n\t\t\t\t<th>Definition</th>\r\n\t\t\t</tr>\r\n\t\t</thead>\r\n\t\t<tbody>\r\n\t\t\t<tr ng-repeat="term in glossary.terms">\r\n\t\t\t\t<td>{{term.term}}</td>\r\n\t\t\t\t<td>{{term.definition}}</td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table>\r\n</div>\r\n</div>\r\n</div>'),t.put("icsm/list/list.html",'<div ng-show="!list || !list.length">\r\n\t<div class="alert alert-warning" role="alert"><strong>Select an area</strong> to find datasets within.</div>\r\n</div>\r\n\r\n<div ng-show="list.length">\r\n   <div class="row">\r\n      <div class="col-md-5" uib-tooltip="Number of intersecting or very near datasets to your area of interest.">\r\n\t      <h4 style="display:inline-block">Found {{matched()| number}} datasets</h4>\r\n      </div>\r\n      <div class="col-md-7">\r\n         <div class="input-group input-group-sm">\r\n            <span class="input-group-addon" id="names1">Filter:</span>\r\n            <input type="text" ng-model="filter" class="form-control"\r\n                   ng-change="update()" placeholder="Filter names" aria-describedby="names1">\r\n         </div>\r\n      </div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-12">\r\n         <div class="panel panel-default">\r\n            <div class="panel-body">\r\n               <span class="listTypeLabel">Filter by type:</span>\r\n               <span ng-repeat="type in filetypes" class="listType">\r\n                  <input type="checkbox" ng-model="type.selected" ng-change="update()"/>\r\n                  <span uib-tooltip="{{type.description}}">{{type.label}} ({{type.count}})</span>\r\n               </span>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n\r\n   <div ng-repeat="available in filteredList" class="well">\r\n      <h5>\r\n         <button class="undecorated" ng-click="expansions[available.source] = !expansions[available.source]" uib-tooltip="Click to collapse/expand this group"\r\n                  aria-expanded="true" aria-controls="collapse{{mappings[available.source].code}}">\r\n            <img ng-src="{{mappings[available.source].image}}" ng-attr-style="height:{{mappings[available.source].height}}px"></img>\r\n         </button>\r\n         <strong>{{available.source}}</strong>\r\n         (Showing {{available.downloadables.length}} of {{fullCount(available.source)}})\r\n         <span class="listTopExpander">\r\n            <button class="undecorated" ng-click="expansions[available.source] = !expansions[available.source]">\r\n               [{{expansions[available.source]?"collapse":"expand"}}]\r\n            </button>\r\n         </span>\r\n      </h5>\r\n      <div uib-collapse="!expansions[available.source]">\r\n         <div class="listRow" ng-class-odd="\'listEven\'" ng-repeat="(key, items) in available.group">\r\n            <div ng-if="key == \'ell\'">\r\n               <h5>hhhhhhhhhhhh\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.ell_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.ell_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_ell | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'las\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.las_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.las_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_las | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'ort\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.ort_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.ort_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_ort | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'asc\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <div>\r\n                     <a href="{{item.asc_url}}">\r\n                        <i class="fa fa-lg fa-download"></i>\r\n                     </a>\r\n                     <common-cc4></common-cc4>\r\n                     <spam class="listItem">{{item.asc_name}}</spam>\r\n                     <span style="float:right;width:8em">Size: {{item.file_size_asc | fileSize}}</span>\r\n                  </div>\r\n                  <div>\r\n                     <a href="{{item.prj_url}}">\r\n                        <i class="fa fa-lg fa-download"></i>\r\n                     </a>\r\n                     <common-cc4></common-cc4>\r\n                     <spam class="listItem">{{item.prj_name}}</spam>\r\n                     <span style="float:right;width:8em">Size: {{item.file_size_prj | fileSize}}</span>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'dem\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.dem_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.dem_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_dem | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n         </div>\r\n         <div style="text-align:right"><button class="undecorated" ng-click="expansions[available.source] = false">[collapse]</button></div>\r\n      </div>\r\n   </div>\r\n</div>'),t.put("icsm/panes/panes.html",'<div class="container contentContainer">\r\n\t<div class="row icsmPanesRow" >\r\n\t\t<div class="icsmPanesCol" ng-class="{\'col-md-12\':!view, \'col-md-7\':view}" style="padding-right:0">\r\n\t\t\t<div class="expToolbar row noPrint" icsm-toolbar-row map="root.map"></div>\r\n\t\t\t<div class="panesMapContainer" geo-map configuration="data.map">\r\n\t\t\t    <geo-extent></geo-extent>\r\n\t\t\t</div>\r\n    \t\t<div geo-draw data="data.map.drawOptions" line-event="elevation.plot.data" rectangle-event="bounds.drawn"></div>\r\n    \t\t<div class="common-legend" common-legend map="data.map"></div>\r\n    \t\t<div icsm-tabs class="icsmTabs"  ng-class="{\'icsmTabsClosed\':!view, \'icsmTabsOpen\':view}"></div>\r\n\t\t</div>\r\n\t\t<div class="icsmPanesColRight" ng-class="{\'hidden\':!view, \'col-md-5\':view}" style="padding-left:0; padding-right:0">\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'download\'" icsm-view></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'maps\'" icsm-maps></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'glossary\'" icsm-glossary></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'help\'" icsm-help></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/panes/tabs.html",'<!-- tabs go here -->\r\n<div id="panesTabsContainer" class="paneRotateTabs" style="opacity:0.9" ng-style="{\'right\' : contentLeft +\'px\'}">\r\n\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'download\'}" ng-click="setView(\'download\')">\r\n\t\t<button class="undecorated">Download</button>\r\n\t</div>\r\n\t<!-- \r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'search\'}" ng-click="setView(\'search\')">\r\n\t\t<button class="undecorated">Search</button>\r\n\t</div>\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'maps\'}" ng-click="setView(\'maps\')">\r\n\t\t<button class="undecorated">Layers</button>\r\n\t</div>\r\n\t-->\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'glossary\'}" ng-click="setView(\'glossary\')">\r\n\t\t<button class="undecorated">Glossary</button>\r\n\t</div>\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'help\'}" ng-click="setView(\'help\')">\r\n\t\t<button class="undecorated">Help</button>\r\n\t</div>\r\n</div>\r\n'),t.put("icsm/results/results.html",'<div ng-show="!list || !list.length">\r\n\t<div class="alert alert-warning" role="alert"><strong>Select an area</strong> to find datasets within.</div>\r\n</div>\r\n\r\n<div ng-show="list.length">\r\n   <div class="row">\r\n      <div class="col-md-5" uib-tooltip="Number of intersecting or very near datasets to your area of interest.">\r\n\t      <h4 style="display:inline-block">Found {{matched()| number}} datasets</h4>\r\n      </div>\r\n      <div class="col-md-7">\r\n         <div class="input-group input-group-sm">\r\n            <span class="input-group-addon" id="names1">Filter:</span>\r\n            <input type="text" ng-model="filter" class="form-control"\r\n                   ng-change="update()" placeholder="Filter names" aria-describedby="names1">\r\n         </div>\r\n      </div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-12">\r\n         <div class="panel panel-default">\r\n            <div class="panel-body">\r\n               <span class="listTypeLabel">Filter by type:</span>\r\n               <span ng-repeat="type in filetypes" class="listType">\r\n                  <input type="checkbox" ng-model="type.selected" ng-change="update()"/>\r\n                  <span uib-tooltip="{{type.description}}">{{type.label}} ({{type.count}})</span>\r\n               </span>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n\r\n   <div ng-repeat="available in filteredList" class="well">\r\n      <h5>\r\n         <button class="undecorated" ng-click="expansions[available.source] = !expansions[available.source]" uib-tooltip="Click to collapse/expand this group"\r\n                  aria-expanded="true" aria-controls="collapse{{mappings[available.source].code}}">\r\n            <img ng-src="{{mappings[available.source].image}}" ng-attr-style="height:{{mappings[available.source].height}}px"></img>\r\n         </button>\r\n         <strong>{{available.source}}</strong>\r\n         (Showing {{available.downloadables.length}} of {{fullCount(available.source)}})\r\n         <span class="listTopExpander">\r\n            <button class="undecorated" ng-click="expansions[available.source] = !expansions[available.source]">\r\n               [{{expansions[available.source]?"collapse":"expand"}}]\r\n            </button>\r\n         </span>\r\n      </h5>\r\n      <div uib-collapse="!expansions[available.source]">\r\n         <div class="listRow" ng-class-odd="\'listEven\'" ng-repeat="(key, items) in available.group">\r\n            <div ng-if="key == \'ell\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.ell_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.ell_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_ell | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'las\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.las_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.las_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_las | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'ort\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.ort_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.ort_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_ort | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'asc\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <div>\r\n                     <a href="{{item.asc_url}}">\r\n                        <i class="fa fa-lg fa-download"></i>\r\n                     </a>\r\n                     <common-cc4></common-cc4>\r\n                     <spam class="listItem">{{item.asc_name}}</spam>\r\n                     <span style="float:right;width:8em">Size: {{item.file_size_asc | fileSize}}</span>\r\n                  </div>\r\n                  <div>\r\n                     <a href="{{item.prj_url}}">\r\n                        <i class="fa fa-lg fa-download"></i>\r\n                     </a>\r\n                     <common-cc4></common-cc4>\r\n                     <spam class="listItem">{{item.prj_name}}</spam>\r\n                     <span style="float:right;width:8em">Size: {{item.file_size_prj | fileSize}}</span>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <div ng-if="key == \'dem\'">\r\n               <h5>\r\n                  <span uib-tooltip="{{filetypes[key].description}}">{{filetypes[key].label}}</span>\r\n                  <input type="checkbox" />\r\n               </h5>\r\n               <div ng-repeat="item in items"\r\n                     data-ng-mouseenter="show(item)" data-ng-mouseleave="hide(item)">\r\n                  <a href="{{item.dem_url}}">\r\n                     <i class="fa fa-lg fa-download"></i>\r\n                  </a>\r\n                  <common-cc4></common-cc4>\r\n                  <spam class="listItem">{{item.dem_name}}</spam>\r\n                  <span style="float:right;width:8em">Size: {{item.file_size_dem | fileSize}}</span>\r\n               </div>\r\n            </div>\r\n         </div>\r\n         <div style="text-align:right"><button class="undecorated" ng-click="expansions[available.source] = false">[collapse]</button></div>\r\n      </div>\r\n   </div>\r\n</div>'),t.put("icsm/select/doc.html",'<div ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-mouseleave="select.lolight(doc)" ng-mouseenter="select.hilight(doc)">\r\n\t<span ng-class="{ellipsis:!expanded}" tooltip-enable="!expanded" style="width:100%;display:inline-block;" \r\n\t\t\ttooltip-class="selectAbstractTooltip" tooltip="{{doc.abstract | truncate : 250}}" tooltip-placement="bottom">\r\n\t\t<button type="button" class="undecorated" ng-click="expanded = !expanded" title="Click to see more about this dataset">\r\n\t\t\t<i class="fa pad-right fa-lg" ng-class="{\'fa-caret-down\':expanded,\'fa-caret-right\':(!expanded)}"></i>\r\n\t\t</button>\r\n\t\t<download-add item="doc" group="group"></download-add>\r\n\t\t<icsm-wms data="doc"></icsm-wms>\r\n\t\t<icsm-bbox data="doc" ng-if="doc.showExtent"></icsm-bbox>\r\n\t\t<a href="http://www.ga.gov.au/metadata-gateway/metadata/record/{{doc.sysId}}" target="_blank" ><strong>{{doc.title}}</strong></a>\r\n\t</span>\r\n\t<span ng-class="{ellipsis:!expanded}" style="width:100%;display:inline-block;padding-right:15px;">\r\n\t\t{{doc.abstract}}\r\n\t</span>\r\n\t<div ng-show="expanded" style="padding-bottom: 5px;">\r\n\t\t<h5>Keywords</h5>\r\n\t\t<div>\r\n\t\t\t<span class="badge" ng-repeat="keyword in doc.keywords track by $index">{{keyword}}</span>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/select/group.html",'<div class="panel panel-default" style="margin-bottom:-5px;" >\r\n\t<div class="panel-heading"><icsm-wms data="group"></icsm-wms> <strong>{{group.title}}</strong></div>\r\n\t<div class="panel-body">\r\n   \t\t<div ng-repeat="doc in group.docs">\r\n   \t\t\t<div select-doc doc="doc" group="group"></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n'),t.put("icsm/select/select.html",'<div>\r\n\t<div style="position:relative;padding:5px;padding-left:10px;" ng-controller="SelectCtrl as select" class="scrollPanel">\r\n\t\t<div class="panel panel-default" style="margin-bottom:-5px">\r\n  \t\t\t<div class="panel-heading">\r\n  \t\t\t\t<h3 class="panel-title">Available datasets</h3>\r\n  \t\t\t</div>\r\n  \t\t\t<div class="panel-body">\r\n\t\t\t\t<div ng-repeat="doc in select.data.response.docs" style="padding-bottom:7px">\r\n\t\t\t\t\t<div select-doc ng-if="doc.type == \'dataset\'" doc="doc"></div>\r\n\t\t\t\t\t<select-group ng-if="doc.type == \'group\'" group="doc"></select-group>\r\n\t\t\t\t</div>\r\n  \t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/splash/splash.html",'<div class="modal-header">\r\n   <h3 class="modal-title splash">ELVIS - Foundation Spatial Data</h3>\r\n</div>\r\n<div class="modal-body" id="accept" ng-form exp-enter="accept()" icsm-splash-modal style="width: 100%; margin-left: auto; margin-right: auto;">\r\n\t<div>\r\n\t\t<p>\r\n\t\t\tHere you can download datasets sourced from jurisdictions.\r\n\t\t</p>\r\n\t\t<p>\r\n\t\t\t<a href="http://www.ga.gov.au/topographic-mapping/digital-elevation-data.html" target="_blank">Find out more on our Elevation page.</a>\r\n\t\t</p>\r\n\t\t<p>\r\n\t\t\tData can be downloaded at <strong>no charge</strong> and there is no limit to how many (please check the file size before you download your files).\r\n\t\t</p>\r\n\t\t<p>\r\n\t\t\t<a href="http://opentopo.sdsc.edu/gridsphere/gridsphere?cid=contributeframeportlet&gs_action=listTools" target="_blank">Click here for Free GIS Tools.</a>\r\n\t\t</p>\r\n      <h5>How to use</h5>\r\n      <p>\r\n         <ul>\r\n            <li>Click on the map, holding the button down,</li>\r\n            <li>Drag to a diagonal corner (not too big, there is a limit of roughly 2x2 degrees)</li>\r\n            <li>On release we will check for data within or very near yur area of interest</li>\r\n            <li>If the list is large you can filter:\r\n               <ul>\r\n                  <li>Partial text match by typing in the filter field and/or</li>\r\n                  <li>By clicking the more button, you can restrict the display to certain file types</li>\r\n               </ul>\r\n            </li>\r\n            <li>Click on any file you would like to download. To reiterate, these files can be huge so take note of the file size before downloading</li>\r\n         </ul>\r\n      </p>\r\n      <h5>Hints</h5>\r\n      <p>\r\n         <ul>\r\n            <li>You can manually type the coordinates into the boxes. After 5 seconds of no changes the area described is checked, just like drawing the box with the mouse.</li>\r\n            <li>Hovering over many items will give you further information about the purpose of the item</li>\r\n            <li>Drawing a polyline allows you to measure distance along the polyline.</li>\r\n            <li>While the tool to draw your area of interest is enabled it is easiest to pan the map using the arrow keys.</li>\r\n            <li>There are many areas where there is no data though the coverage is improving all the time.</li\r\n         </ul>\r\n      </p>\r\n\t</div>\r\n   <div style="padding:30px; padding-top:0; padding-bottom:40px; width:100%">\r\n\t\t<div class="pull-right">\r\n\t\t  \t<button type="button" class="btn btn-primary ng-pristine ng-valid ng-touched" ng-model="seenSplash" ng-focus="" ng-click="accept()">Continue</button>\r\n\t\t</div>\r\n\t</div>\r\n\t<div ng-show="messages.length > 0" class="container" style="width:100%; max-height:250px; overflow-y:auto">\r\n\t\t<div class="row" ng-class-even="\'grayline\'" style="font-weight:bold">\r\n\t\t\t<div class="col-sm-12" ><h3>News</h3></div>\r\n\t\t</div>\r\n\r\n\t\t<div class="row"ng-class-even="\'grayline\'" style="max-height:400px;overflow:auto" ng-repeat="message in messages | sortNotes">\r\n\t\t\t<div class="col-sm-12">\r\n\t\t\t\t<h4>{{message.title}} <span class="pull-right" style="font-size:70%">Created: {{message.creationDate | date : "dd/MM/yyyy"}}</span></h4>\r\n\t\t\t\t<div ng-bind-html="message.description"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/themes/themes.html",'<div class="dropdown themesdropdown">\r\n  <button class="btn btn-default dropdown-toggle themescurrent" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">\r\n    Theme\r\n    <span class="caret"></span>\r\n  </button>\r\n  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">\r\n    <li ng-repeat="item in themes">\r\n       <a href="#" title="{{item.title}}" ng-href="{{item.url}}" class="themesItemCompact">\r\n         <span class="icsm-icon" ng-class="item.className"></span>\r\n         <strong style="vertical-align:top;font-size:110%">{{item.label}}</strong>\r\n       </a>\r\n    </li>\r\n  </ul>\r\n</div>'),t.put("icsm/toolbar/toolbar.html",'<div icsm-toolbar>\r\n\t<div class="row toolBarGroup">\r\n\t\t<div class="btn-group searchBar" ng-show="root.whichSearch != \'region\'">\r\n\t\t\t<div class="input-group" geo-search>\r\n\t\t\t\t<input type="text" ng-autocomplete ng-model="values.from.description" options=\'{country:"au"}\'\r\n\t\t\t\t\t\t\tsize="32" title="Select a locality to pan the map to." class="form-control" aria-label="...">\r\n\t\t\t\t<div class="input-group-btn">\r\n    \t\t\t\t<button ng-click="zoom(false)" exp-ga="[\'send\', \'event\', \'icsm\', \'click\', \'zoom to location\']"\r\n\t\t\t\t\t\tclass="btn btn-default"\r\n\t\t\t\t\t\ttitle="Pan and potentially zoom to location."><i class="fa fa-search"></i></button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="pull-right">\r\n\t\t\t<div class="btn-toolbar radCore" role="toolbar"  icsm-toolbar>\r\n\t\t\t\t<div class="btn-group">\r\n\t\t\t\t\t<!-- < icsm-state-toggle></icsm-state-toggle> -->\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="btn-toolbar" style="margin:right:10px;display:inline-block">\r\n\t\t\t\t<div class="btn-group">\r\n\t\t\t\t\t<span class="btn btn-default" common-baselayer-control max-zoom="16" title="Satellite to Topography bias on base map."></span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("icsm/view/view.html",'<div class="container-fluid downloadPane" >\r\n\t<div class="row">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<h4><icsm-wms data="data.item" ng-title="data.item.abstract"></icsm-wms>{{data.item.title}}</h4>\r\n  \t\t\t</div>\r\n\t</div>\r\n\t<icsm-clip data="data.item"></icsm-clip>\r\n\t<icsm-list></icsm-list>\r\n</div>')}]);